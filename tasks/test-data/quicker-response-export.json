{"nextPageToken":"ZAACAA==","units":[{"currentState":"inactive","desiredState":"inactive","name":"activemq@.service","options":[{"name":"Description","section":"Unit","value":"Activemq"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/docker pull build.sofi.com:5000/sofi-activemq"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill activemq"},{"name":"ExecStart","section":"Service","value":"/usr/bin/docker run --rm -p \"${COREOS_PRIVATE_IPV4}\":61613:61613      -p \"${COREOS_PRIVATE_IPV4}\":61616:61616      -p \"${COREOS_PRIVATE_IPV4}\":61617:61617      -p \"${COREOS_PRIVATE_IPV4}\":8161:8161      -p \"${COREOS_PRIVATE_IPV4}\":11099:11099      -e ACTIVEMQ_OPTS_MEMORY=\"-Xms1G -Xmx1G\"      -e SERVICE_61616_NAME=\"activemq-broker\"      -e SERVICE_61616_ID=\"activemq-broker-%i\"      -e SERVICE_61616_PORT=\"61616\"      --name activemq      build.sofi.com:5000/sofi-activemq:latest"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/activemq-broker-%i; sleep 30;'"},{"name":"ExecStop","section":"Service","value":"/usr/bin/docker stop activemq"},{"name":"X-Conflicts","section":"X-Fleet","value":"activemq@*.service"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"launched","desiredState":"launched","machineID":"277d71246ac8425b832426a818dedca4","name":"activemq@1.service","options":[{"name":"Description","section":"Unit","value":"Activemq"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/docker pull build.sofi.com:5000/sofi-activemq"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill activemq"},{"name":"ExecStart","section":"Service","value":"/usr/bin/docker run --rm -p \"${COREOS_PRIVATE_IPV4}\":61613:61613      -p \"${COREOS_PRIVATE_IPV4}\":61616:61616      -p \"${COREOS_PRIVATE_IPV4}\":61617:61617      -p \"${COREOS_PRIVATE_IPV4}\":8161:8161      -p \"${COREOS_PRIVATE_IPV4}\":11099:11099      -e ACTIVEMQ_OPTS_MEMORY=\"-Xms1G -Xmx1G\"      -e SERVICE_61616_NAME=\"activemq-broker\"      -e SERVICE_61616_ID=\"activemq-broker-%i\"      -e SERVICE_61616_PORT=\"61616\"      --name activemq      build.sofi.com:5000/sofi-activemq:latest"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/activemq-broker-%i; sleep 30;'"},{"name":"ExecStop","section":"Service","value":"/usr/bin/docker stop activemq"},{"name":"X-Conflicts","section":"X-Fleet","value":"activemq@*.service"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"inactive","desiredState":"inactive","name":"activities@.service","options":[{"name":"Description","section":"Unit","value":"activities app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"activities"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/activities"},{"name":"Environment","section":"Service","value":"CONTAINER=activities"},{"name":"Environment","section":"Service","value":"EXT_PORT=9020"},{"name":"Environment","section":"Service","value":"INT_PORT=9000"},{"name":"Environment","section":"Service","value":"CONTEXT=w/"},{"name":"Environment","section":"Service","value":"/bin/bash -c \"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"/bin/bash -c \"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/sofi/apps/conf:/config          -v /data/newrelic:/data/newrelic          -v /shared:/shared          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/${CONTEXT} | grep HTTP | grep 200 || exit 255\"          -e NEW_RELIC_APP_NAME=\"${CONTAINER} (${ENV})\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i; sleep 15;'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rmi ${DOCKER_REPO}:${TAG}'"},{"name":"Conflicts","section":"X-Fleet","value":"activities*"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"launched","desiredState":"launched","machineID":"1e640f5ec22f4a3dbc8fa70b9cd9a445","name":"activities@2.service","options":[{"name":"Description","section":"Unit","value":"activities app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"activities"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/activities"},{"name":"Environment","section":"Service","value":"CONTAINER=activities"},{"name":"Environment","section":"Service","value":"EXT_PORT=9020"},{"name":"Environment","section":"Service","value":"INT_PORT=9000"},{"name":"Environment","section":"Service","value":"CONTEXT=w/"},{"name":"Environment","section":"Service","value":"/bin/bash -c \"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"/bin/bash -c \"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/sofi/apps/conf:/config          -v /data/newrelic:/data/newrelic          -v /shared:/shared          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/${CONTEXT} | grep HTTP | grep 200 || exit 255\"          -e NEW_RELIC_APP_NAME=\"${CONTAINER} (${ENV})\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i; sleep 15;'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rmi ${DOCKER_REPO}:${TAG}'"},{"name":"Conflicts","section":"X-Fleet","value":"activities*"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"inactive","desiredState":"inactive","name":"advisor@.service","options":[{"name":"Description","section":"Unit","value":"wealth app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"advisor"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/wealth-advisor"},{"name":"Environment","section":"Service","value":"CONTAINER=advisor"},{"name":"Environment","section":"Service","value":"EXT_PORT=9023"},{"name":"Environment","section":"Service","value":"INT_PORT=9000"},{"name":"Environment","section":"Service","value":"CONTEXT=advisor/"},{"name":"Environment","section":"Service","value":"/bin/bash -c \"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"/bin/bash -c \"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/sofi/apps/conf:/config          -v /data/newrelic:/data/newrelic          -v /shared:/shared          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/${CONTEXT} | grep HTTP | grep 200 || exit 255\"          -e NEW_RELIC_APP_NAME=\"${CONTAINER} (${ENV})\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i; sleep 15;'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rmi ${DOCKER_REPO}:${TAG}'"},{"name":"Conflicts","section":"X-Fleet","value":"advisor*"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"launched","desiredState":"launched","machineID":"6a9f464f4a24454394aacc383cce0086","name":"advisor@2.service","options":[{"name":"Description","section":"Unit","value":"wealth app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"advisor"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/wealth-advisor"},{"name":"Environment","section":"Service","value":"CONTAINER=advisor"},{"name":"Environment","section":"Service","value":"EXT_PORT=9023"},{"name":"Environment","section":"Service","value":"INT_PORT=9000"},{"name":"Environment","section":"Service","value":"CONTEXT=advisor/"},{"name":"Environment","section":"Service","value":"/bin/bash -c \"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"/bin/bash -c \"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/sofi/apps/conf:/config          -v /data/newrelic:/data/newrelic          -v /shared:/shared          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/${CONTEXT} | grep HTTP | grep 200 || exit 255\"          -e NEW_RELIC_APP_NAME=\"${CONTAINER} (${ENV})\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i; sleep 15;'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rmi ${DOCKER_REPO}:${TAG}'"},{"name":"Conflicts","section":"X-Fleet","value":"advisor*"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"inactive","desiredState":"inactive","name":"authenticate@.service","options":[{"name":"Description","section":"Unit","value":"authenticate"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"authenticate"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/sofi-operator"},{"name":"Environment","section":"Service","value":"CONTAINER=authenticate"},{"name":"Environment","section":"Service","value":"EXT_PORT=9014"},{"name":"Environment","section":"Service","value":"INT_PORT=9000"},{"name":"Environment","section":"Service","value":"CONTEXT=u/"},{"name":"Environment","section":"Service","value":"/bin/bash -c \"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"/bin/bash -c \"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/sofi/apps/conf:/config          -v /data/newrelic:/data/newrelic          -v /shared:/shared          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/${CONTEXT} | grep HTTP | grep 200 || exit 255\"          -e NEW_RELIC_APP_NAME=\"${CONTAINER} (${ENV})\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i; sleep 15;'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rmi ${DOCKER_REPO}:${TAG}'"},{"name":"Conflicts","section":"X-Fleet","value":"authenticate*"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"inactive","desiredState":"inactive","name":"authorize@.service","options":[{"name":"Description","section":"Unit","value":"authorize app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"authorize"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/authorize"},{"name":"Environment","section":"Service","value":"CONTAINER=authorize"},{"name":"Environment","section":"Service","value":"EXT_PORT=9007"},{"name":"Environment","section":"Service","value":"INT_PORT=9000"},{"name":"Environment","section":"Service","value":"CONTEXT=a/"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          --dns=\"${COREOS_PRIVATE_IPV4}\"          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/sofi/apps/conf:/config          -v /data/newrelic:/data/newrelic          -v /shared:/shared          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/${CONTEXT} | grep HTTP | grep 200 || exit 255\"          -e NEW_RELIC_APP_NAME=\"${CONTAINER} (${ENV})\"          -e NEW_RELIC_HOST_DISPLAY_NAME=\"%H\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i; sleep 15;'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"Conflicts","section":"X-Fleet","value":"authorize*"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"launched","desiredState":"launched","machineID":"6a9f464f4a24454394aacc383cce0086","name":"authorize@1.service","options":[{"name":"Description","section":"Unit","value":"authorize app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"authorize"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/authorize"},{"name":"Environment","section":"Service","value":"CONTAINER=authorize"},{"name":"Environment","section":"Service","value":"EXT_PORT=9007"},{"name":"Environment","section":"Service","value":"INT_PORT=9000"},{"name":"Environment","section":"Service","value":"CONTEXT=a/"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          --dns=\"${COREOS_PRIVATE_IPV4}\"          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/sofi/apps/conf:/config          -v /data/newrelic:/data/newrelic          -v /shared:/shared          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/${CONTEXT} | grep HTTP | grep 200 || exit 255\"          -e NEW_RELIC_APP_NAME=\"${CONTAINER} (${ENV})\"          -e NEW_RELIC_HOST_DISPLAY_NAME=\"%H\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i; sleep 15;'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"Conflicts","section":"X-Fleet","value":"authorize*"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"inactive","desiredState":"inactive","name":"autovault@.service","options":[{"name":"Description","section":"Unit","value":"autovault"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"users-cloudconfig"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"EnvironmentFile","section":"Service","value":"/shared/config/vault_tokens/master.env"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/autovault"},{"name":"Environment","section":"Service","value":"CONTAINER=autovault"},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"-/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H      -v /shared/config/vault_policies:/vault_policies      -v /shared/config/vault_tokens:/vault_tokens      -e NODE_IP=\"${COREOS_PRIVATE_IPV4}\"      -e VAULT_ADDR=\"${VAULT_ADDR}\"      -e VAULT_TOKEN=\"${VAULT_TOKEN}\"      -e SERVICE_NAME=\"${CONTAINER}\"      -e SERVICE_ID=\"${CONTAINER}\"      ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/usr/bin/docker stop ${CONTAINER}"},{"name":"ExecStop","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"Conflicts","section":"X-Fleet","value":"autovault@*.service"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=infra"}]},{"currentState":"inactive","desiredState":"inactive","name":"autovault@.timer","options":[{"name":"Description","section":"Unit","value":"Runs autovault weekly"},{"name":"OnCalendar","section":"Timer","value":"Sun*-*-* 06:00:00"},{"name":"Unit","section":"Timer","value":"%p@%i.service"},{"name":"WantedBy","section":"Install","value":"timers.target"},{"name":"MachineOf","section":"X-Fleet","value":"%p@%i.service"}]},{"currentState":"launched","desiredState":"launched","machineID":"566d07a3f0594a3c8fa44f75a52416e2","name":"autovault@1.service","options":[{"name":"Description","section":"Unit","value":"autovault"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"users-cloudconfig"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"EnvironmentFile","section":"Service","value":"/shared/config/vault_tokens/master.env"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/autovault"},{"name":"Environment","section":"Service","value":"CONTAINER=autovault"},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"-/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H      -v /shared/config/vault_policies:/vault_policies      -v /shared/config/vault_tokens:/vault_tokens      -e NODE_IP=\"${COREOS_PRIVATE_IPV4}\"      -e VAULT_ADDR=\"${VAULT_ADDR}\"      -e VAULT_TOKEN=\"${VAULT_TOKEN}\"      -e SERVICE_NAME=\"${CONTAINER}\"      -e SERVICE_ID=\"${CONTAINER}\"      ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/usr/bin/docker stop ${CONTAINER}"},{"name":"ExecStop","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"Conflicts","section":"X-Fleet","value":"autovault@*.service"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=infra"}]},{"currentState":"launched","desiredState":"launched","machineID":"566d07a3f0594a3c8fa44f75a52416e2","name":"autovault@1.timer","options":[{"name":"Description","section":"Unit","value":"Runs autovault weekly"},{"name":"OnCalendar","section":"Timer","value":"Sun*-*-* 06:00:00"},{"name":"Unit","section":"Timer","value":"%p@%i.service"},{"name":"WantedBy","section":"Install","value":"timers.target"},{"name":"MachineOf","section":"X-Fleet","value":"%p@%i.service"}]},{"currentState":"inactive","desiredState":"inactive","name":"autovault@service.service","options":[{"name":"Description","section":"Unit","value":"autovault"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"users-cloudconfig"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"EnvironmentFile","section":"Service","value":"/shared/config/vault_tokens/master.env"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/autovault"},{"name":"Environment","section":"Service","value":"CONTAINER=autovault"},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"-/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H      -v /shared/config/vault_policies:/vault_policies      -v /shared/config/vault_tokens:/vault_tokens      -e NODE_IP=\"${COREOS_PRIVATE_IPV4}\"      -e VAULT_ADDR=\"${VAULT_ADDR}\"      -e VAULT_TOKEN=\"${VAULT_TOKEN}\"      -e SERVICE_NAME=\"${CONTAINER}\"      -e SERVICE_ID=\"${CONTAINER}\"      ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/usr/bin/docker stop ${CONTAINER}"},{"name":"ExecStop","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"Conflicts","section":"X-Fleet","value":"autovault@*.service"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=infra"}]},{"currentState":"inactive","desiredState":"inactive","name":"bamboo@.service","options":[{"name":"Description","section":"Unit","value":"bamboo app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"bamboo"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"CONTAINER=bamboo"},{"name":"Environment","section":"Service","value":"EXT_PORT=8085"},{"name":"Environment","section":"Service","value":"INT_PORT=8085"},{"name":"Environment","section":"Service","value":"CONTEXT=bamboo"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/${CONTAINER}"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"-/bin/bash -c '          /usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /var/run/docker.sock:/var/run/docker.sock          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -o /dev/null -w %{http_code} http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/${CONTEXT} | egrep \\(200\\|302\\)\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i;'"},{"name":"ExecStop","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"Conflicts","section":"X-Fleet","value":"${CONTAINER}*"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"loaded","desiredState":"loaded","machineID":"f7ef52fc940a41c78280c8ad6138b88e","name":"bamboo@1.service","options":[{"name":"Description","section":"Unit","value":"bamboo app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"bamboo"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"CONTAINER=bamboo"},{"name":"Environment","section":"Service","value":"EXT_PORT=8085"},{"name":"Environment","section":"Service","value":"INT_PORT=8085"},{"name":"Environment","section":"Service","value":"CONTEXT=bamboo"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/${CONTAINER}"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"-/bin/bash -c '          /usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /var/run/docker.sock:/var/run/docker.sock          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -o /dev/null -w %{http_code} http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/${CONTEXT} | egrep \\(200\\|302\\)\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i;'"},{"name":"ExecStop","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"Conflicts","section":"X-Fleet","value":"${CONTAINER}*"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"inactive","desiredState":"inactive","name":"borrower@.service","options":[{"name":"Description","section":"Unit","value":"sofi-borrower app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"borrower"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"TimeoutStopSec","section":"Service","value":"120"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/sofi-borrower"},{"name":"Environment","section":"Service","value":"CONTAINER=borrower"},{"name":"Environment","section":"Service","value":"EXT_PORT=9001"},{"name":"Environment","section":"Service","value":"INT_PORT=9000"},{"name":"Environment","section":"Service","value":"CONTEXT=b/"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          --dns=\"${COREOS_PRIVATE_IPV4}\"          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/sofi/apps/conf:/config          -v /data/newrelic:/data/newrelic          -v /shared:/shared          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/${CONTEXT} | grep HTTP | grep 200 || exit 255\"          -e NEW_RELIC_APP_NAME=\"${CONTAINER} (${ENV})\"          -e NEW_RELIC_HOST_DISPLAY_NAME=\"%H\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i; sleep 15;'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"Conflicts","section":"X-Fleet","value":"borrower@*.service"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"launched","desiredState":"launched","machineID":"12585ae826554b49b2fdf78ecb2a6d15","name":"borrower@1.service","options":[{"name":"Description","section":"Unit","value":"sofi-borrower app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"borrower"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"TimeoutStopSec","section":"Service","value":"120"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/sofi-borrower"},{"name":"Environment","section":"Service","value":"CONTAINER=borrower"},{"name":"Environment","section":"Service","value":"EXT_PORT=9001"},{"name":"Environment","section":"Service","value":"INT_PORT=9000"},{"name":"Environment","section":"Service","value":"CONTEXT=b/"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          --dns=\"${COREOS_PRIVATE_IPV4}\"          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/sofi/apps/conf:/config          -v /data/newrelic:/data/newrelic          -v /shared:/shared          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/${CONTEXT} | grep HTTP | grep 200 || exit 255\"          -e NEW_RELIC_APP_NAME=\"${CONTAINER} (${ENV})\"          -e NEW_RELIC_HOST_DISPLAY_NAME=\"%H\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i; sleep 15;'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"Conflicts","section":"X-Fleet","value":"borrower@*.service"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"launched","desiredState":"launched","machineID":"8347693a19394ab58867d3863eec5581","name":"borrower@2.service","options":[{"name":"Description","section":"Unit","value":"sofi-borrower app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"borrower"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"TimeoutStopSec","section":"Service","value":"120"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/sofi-borrower"},{"name":"Environment","section":"Service","value":"CONTAINER=borrower"},{"name":"Environment","section":"Service","value":"EXT_PORT=9001"},{"name":"Environment","section":"Service","value":"INT_PORT=9000"},{"name":"Environment","section":"Service","value":"CONTEXT=b/"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          --dns=\"${COREOS_PRIVATE_IPV4}\"          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/sofi/apps/conf:/config          -v /data/newrelic:/data/newrelic          -v /shared:/shared          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/${CONTEXT} | grep HTTP | grep 200 || exit 255\"          -e NEW_RELIC_APP_NAME=\"${CONTAINER} (${ENV})\"          -e NEW_RELIC_HOST_DISPLAY_NAME=\"%H\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i; sleep 15;'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"Conflicts","section":"X-Fleet","value":"borrower@*.service"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"inactive","desiredState":"inactive","name":"cassandra-backup@.service","options":[{"name":"Description","section":"Unit","value":"Cassandra Backup Service"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"cassandra-backup"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"EnvironmentFile","section":"Service","value":"/mnt/efs/config/vault.env"},{"name":"Environment","section":"Service","value":"CONTAINER=cassandra-backup"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/cassandra-backup"},{"name":"Environment","section":"Service","value":"\"BUCKET=$(if [ $(etcdctl get /environment) == production ]; then echo cassandra.sofi.com; else echo cassandra.sofitest.com; fi)\""},{"name":"Environment","section":"Service","value":"BUCKET_KEY=backups"},{"name":"Environment","section":"Service","value":"NAME=cassandra"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}'"},{"name":"ExecStart","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker run --rm --name ${CONTAINER} -h %H          -e HOST=\"${COREOS_PRIVATE_IPV4}\"          -e NAME=\"${NAME}\"          -e BUCKET=\"${BUCKET}\"          -e BUCKET_KEY=${BUCKET_KEY}          -e AWS_ACCESS_KEY=$(curl -s -X GET -H \"X-Vault-Token: ${VAULT_TOKEN}\" ${VAULT_ADDR}/v1/secret/service/s3/backup | jq -r .data.access_key)          -e AWS_SECRET_ACCESS_KEY=$(curl -s -X GET -H \"X-Vault-Token: ${VAULT_TOKEN}\" ${VAULT_ADDR}/v1/secret/service/s3/backup | jq -r .data.secret_key)          ${DOCKER_REPO}'"},{"name":"MachineOf","section":"X-Fleet","value":"cassandra@%i.service"},{"name":"Conflicts","section":"X-Fleet","value":"cassandra-backup@*.service"}]},{"currentState":"inactive","desiredState":"inactive","name":"cassandra-backup@.timer","options":[{"name":"Description","section":"Unit","value":"Run consul-backup service every day"},{"name":"OnCalendar","section":"Timer","value":"hourly"},{"name":"Unit","section":"Timer","value":"%p@%i.service"},{"name":"WantedBy","section":"Install","value":"timers.target"},{"name":"MachineOf","section":"X-Fleet","value":"%p@%i.service"}]},{"currentState":"launched","desiredState":"launched","machineID":"566d07a3f0594a3c8fa44f75a52416e2","name":"cassandra-backup@1.service","options":[{"name":"Description","section":"Unit","value":"Cassandra Backup Service"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"cassandra-backup"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"EnvironmentFile","section":"Service","value":"/mnt/efs/config/vault.env"},{"name":"Environment","section":"Service","value":"CONTAINER=cassandra-backup"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/cassandra-backup"},{"name":"Environment","section":"Service","value":"\"BUCKET=$(if [ $(etcdctl get /environment) == production ]; then echo cassandra.sofi.com; else echo cassandra.sofitest.com; fi)\""},{"name":"Environment","section":"Service","value":"BUCKET_KEY=backups"},{"name":"Environment","section":"Service","value":"NAME=cassandra"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}'"},{"name":"ExecStart","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker run --rm --name ${CONTAINER} -h %H          -e HOST=\"${COREOS_PRIVATE_IPV4}\"          -e NAME=\"${NAME}\"          -e BUCKET=\"${BUCKET}\"          -e BUCKET_KEY=${BUCKET_KEY}          -e AWS_ACCESS_KEY=$(curl -s -X GET -H \"X-Vault-Token: ${VAULT_TOKEN}\" ${VAULT_ADDR}/v1/secret/service/s3/backup | jq -r .data.access_key)          -e AWS_SECRET_ACCESS_KEY=$(curl -s -X GET -H \"X-Vault-Token: ${VAULT_TOKEN}\" ${VAULT_ADDR}/v1/secret/service/s3/backup | jq -r .data.secret_key)          ${DOCKER_REPO}'"},{"name":"MachineOf","section":"X-Fleet","value":"cassandra@%i.service"},{"name":"Conflicts","section":"X-Fleet","value":"cassandra-backup@*.service"}]},{"currentState":"launched","desiredState":"launched","machineID":"566d07a3f0594a3c8fa44f75a52416e2","name":"cassandra-backup@1.timer","options":[{"name":"Description","section":"Unit","value":"Run consul-backup service every day"},{"name":"OnCalendar","section":"Timer","value":"hourly"},{"name":"Unit","section":"Timer","value":"%p@%i.service"},{"name":"WantedBy","section":"Install","value":"timers.target"},{"name":"MachineOf","section":"X-Fleet","value":"%p@%i.service"}]},{"currentState":"launched","desiredState":"launched","machineID":"5a2124ac313e4008824cefacf90db0b4","name":"cassandra-backup@2.service","options":[{"name":"Description","section":"Unit","value":"Cassandra Backup Service"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"cassandra-backup"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"EnvironmentFile","section":"Service","value":"/mnt/efs/config/vault.env"},{"name":"Environment","section":"Service","value":"CONTAINER=cassandra-backup"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/cassandra-backup"},{"name":"Environment","section":"Service","value":"\"BUCKET=$(if [ $(etcdctl get /environment) == production ]; then echo cassandra.sofi.com; else echo cassandra.sofitest.com; fi)\""},{"name":"Environment","section":"Service","value":"BUCKET_KEY=backups"},{"name":"Environment","section":"Service","value":"NAME=cassandra"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}'"},{"name":"ExecStart","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker run --rm --name ${CONTAINER} -h %H          -e HOST=\"${COREOS_PRIVATE_IPV4}\"          -e NAME=\"${NAME}\"          -e BUCKET=\"${BUCKET}\"          -e BUCKET_KEY=${BUCKET_KEY}          -e AWS_ACCESS_KEY=$(curl -s -X GET -H \"X-Vault-Token: ${VAULT_TOKEN}\" ${VAULT_ADDR}/v1/secret/service/s3/backup | jq -r .data.access_key)          -e AWS_SECRET_ACCESS_KEY=$(curl -s -X GET -H \"X-Vault-Token: ${VAULT_TOKEN}\" ${VAULT_ADDR}/v1/secret/service/s3/backup | jq -r .data.secret_key)          ${DOCKER_REPO}'"},{"name":"MachineOf","section":"X-Fleet","value":"cassandra@%i.service"},{"name":"Conflicts","section":"X-Fleet","value":"cassandra-backup@*.service"}]},{"currentState":"launched","desiredState":"launched","machineID":"5a2124ac313e4008824cefacf90db0b4","name":"cassandra-backup@2.timer","options":[{"name":"Description","section":"Unit","value":"Run consul-backup service every day"},{"name":"OnCalendar","section":"Timer","value":"hourly"},{"name":"Unit","section":"Timer","value":"%p@%i.service"},{"name":"WantedBy","section":"Install","value":"timers.target"},{"name":"MachineOf","section":"X-Fleet","value":"%p@%i.service"}]},{"currentState":"inactive","desiredState":"inactive","name":"cassandra@.service","options":[{"name":"Description","section":"Unit","value":"Cassandra"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"cassandra"},{"name":"Restart","section":"Service","value":"always"},{"name":"RestartSec","section":"Service","value":"10"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"CONTAINER=cassandra"},{"name":"Environment","section":"Service","value":"/usr/bin/sh -c 'DOCKER_REPO=`etcdctl get /docker/cassandra/version`'"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/bash -c 'if ! etcdctl get /cassandra/seed;                                    then etcdctl set /cassandra/seed ${COREOS_PRIVATE_IPV4};                                    else echo \"seed already set\";                                  fi;'"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker pull ${DOCKER_REPO}"},{"name":"ExecStart","section":"Service","value":"-/bin/bash -c '      CASSANDRA_SEED=\"\";      if [ `etcdctl get /cassandra/seed` != ${COREOS_PRIVATE_IPV4} ];        then CASSANDRA_SEED=\"-e CASSANDRA_SEEDS=`etcdctl get /cassandra/seed`\";        else echo \"I am Cassandra Seed\";      fi;      echo \"This is the seed: $CASSANDRA_SEED\";      /usr/bin/docker run --name ${CONTAINER} -h %H          -e CASSANDRA_BROADCAST_ADDRESS=${COREOS_PRIVATE_IPV4}          $CASSANDRA_SEED          -e CASSANDRA_CLUSTER_NAME=\"SoFi Cluster\"          -e CASSANDRA_DC=\"us-west-2\"          -e CASSANDRA_ENDPOINT_SNITCH=\"GossipingPropertyFileSnitch\"          -e CASSANDRA_AUTHENTICATOR=\"PasswordAuthenticator\"          -e CASSANDRA_AUTHORIZER=\"CassandraAuthorizer\"          -e SERVICE_9042_NAME=\"${CONTAINER}\"          -e SERVICE_9042_ID=\"${CONTAINER}-%i\"          -e SERVICE_7000_NAME=\"${CONTAINER}-gossip\"          -e SERVICE_7000_ID=\"${CONTAINER}-gossip-%i\"          -e SERVICE_CHECK_SCRIPT=\"netstat -an | grep 7000 || exit 255\"          -p \"${COREOS_PRIVATE_IPV4}\":7000:7000          -p \"${COREOS_PRIVATE_IPV4}\":9042:9042          -v /var/lib/docker/cassandra:/var/lib/cassandra          ${DOCKER_REPO}'"},{"name":"ExecStop","section":"Service","value":"/usr/bin/docker stop ${CONTAINER}"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '      DOCKER_REPO=\"`/usr/bin/etcdctl get /docker/cassandra/version`\";      /usr/bin/docker rmi ${DOCKER_REPO}'"},{"name":"Conflicts","section":"X-Fleet","value":"cassandra@*.service"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=infra"}]},{"currentState":"launched","desiredState":"launched","machineID":"566d07a3f0594a3c8fa44f75a52416e2","name":"cassandra@1.service","options":[{"name":"Description","section":"Unit","value":"Cassandra"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"cassandra"},{"name":"Restart","section":"Service","value":"always"},{"name":"RestartSec","section":"Service","value":"10"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"CONTAINER=cassandra"},{"name":"Environment","section":"Service","value":"/usr/bin/sh -c 'DOCKER_REPO=`etcdctl get /docker/cassandra/version`'"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/bash -c 'if ! etcdctl get /cassandra/seed;                                    then etcdctl set /cassandra/seed ${COREOS_PRIVATE_IPV4};                                    else echo \"seed already set\";                                  fi;'"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker pull ${DOCKER_REPO}"},{"name":"ExecStart","section":"Service","value":"-/bin/bash -c '      CASSANDRA_SEED=\"\";      if [ `etcdctl get /cassandra/seed` != ${COREOS_PRIVATE_IPV4} ];        then CASSANDRA_SEED=\"-e CASSANDRA_SEEDS=`etcdctl get /cassandra/seed`\";        else echo \"I am Cassandra Seed\";      fi;      echo \"This is the seed: $CASSANDRA_SEED\";      /usr/bin/docker run --name ${CONTAINER} -h %H          -e CASSANDRA_BROADCAST_ADDRESS=${COREOS_PRIVATE_IPV4}          $CASSANDRA_SEED          -e CASSANDRA_CLUSTER_NAME=\"SoFi Cluster\"          -e CASSANDRA_DC=\"us-west-2\"          -e CASSANDRA_ENDPOINT_SNITCH=\"GossipingPropertyFileSnitch\"          -e CASSANDRA_AUTHENTICATOR=\"PasswordAuthenticator\"          -e CASSANDRA_AUTHORIZER=\"CassandraAuthorizer\"          -e SERVICE_9042_NAME=\"${CONTAINER}\"          -e SERVICE_9042_ID=\"${CONTAINER}-%i\"          -e SERVICE_7000_NAME=\"${CONTAINER}-gossip\"          -e SERVICE_7000_ID=\"${CONTAINER}-gossip-%i\"          -e SERVICE_CHECK_SCRIPT=\"netstat -an | grep 7000 || exit 255\"          -p \"${COREOS_PRIVATE_IPV4}\":7000:7000          -p \"${COREOS_PRIVATE_IPV4}\":9042:9042          -v /var/lib/docker/cassandra:/var/lib/cassandra          ${DOCKER_REPO}'"},{"name":"ExecStop","section":"Service","value":"/usr/bin/docker stop ${CONTAINER}"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '      DOCKER_REPO=\"`/usr/bin/etcdctl get /docker/cassandra/version`\";      /usr/bin/docker rmi ${DOCKER_REPO}'"},{"name":"Conflicts","section":"X-Fleet","value":"cassandra@*.service"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=infra"}]},{"currentState":"launched","desiredState":"launched","machineID":"5a2124ac313e4008824cefacf90db0b4","name":"cassandra@2.service","options":[{"name":"Description","section":"Unit","value":"Cassandra"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"cassandra"},{"name":"Restart","section":"Service","value":"always"},{"name":"RestartSec","section":"Service","value":"10"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"CONTAINER=cassandra"},{"name":"Environment","section":"Service","value":"/usr/bin/sh -c 'DOCKER_REPO=`etcdctl get /docker/cassandra/version`'"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/bash -c 'if ! etcdctl get /cassandra/seed;                                    then etcdctl set /cassandra/seed ${COREOS_PRIVATE_IPV4};                                    else echo \"seed already set\";                                  fi;'"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker pull ${DOCKER_REPO}"},{"name":"ExecStart","section":"Service","value":"-/bin/bash -c '      CASSANDRA_SEED=\"\";      if [ `etcdctl get /cassandra/seed` != ${COREOS_PRIVATE_IPV4} ];        then CASSANDRA_SEED=\"-e CASSANDRA_SEEDS=`etcdctl get /cassandra/seed`\";        else echo \"I am Cassandra Seed\";      fi;      echo \"This is the seed: $CASSANDRA_SEED\";      /usr/bin/docker run --name ${CONTAINER} -h %H          -e CASSANDRA_BROADCAST_ADDRESS=${COREOS_PRIVATE_IPV4}          $CASSANDRA_SEED          -e CASSANDRA_CLUSTER_NAME=\"SoFi Cluster\"          -e CASSANDRA_DC=\"us-west-2\"          -e CASSANDRA_ENDPOINT_SNITCH=\"GossipingPropertyFileSnitch\"          -e CASSANDRA_AUTHENTICATOR=\"PasswordAuthenticator\"          -e CASSANDRA_AUTHORIZER=\"CassandraAuthorizer\"          -e SERVICE_9042_NAME=\"${CONTAINER}\"          -e SERVICE_9042_ID=\"${CONTAINER}-%i\"          -e SERVICE_7000_NAME=\"${CONTAINER}-gossip\"          -e SERVICE_7000_ID=\"${CONTAINER}-gossip-%i\"          -e SERVICE_CHECK_SCRIPT=\"netstat -an | grep 7000 || exit 255\"          -p \"${COREOS_PRIVATE_IPV4}\":7000:7000          -p \"${COREOS_PRIVATE_IPV4}\":9042:9042          -v /var/lib/docker/cassandra:/var/lib/cassandra          ${DOCKER_REPO}'"},{"name":"ExecStop","section":"Service","value":"/usr/bin/docker stop ${CONTAINER}"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '      DOCKER_REPO=\"`/usr/bin/etcdctl get /docker/cassandra/version`\";      /usr/bin/docker rmi ${DOCKER_REPO}'"},{"name":"Conflicts","section":"X-Fleet","value":"cassandra@*.service"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=infra"}]},{"currentState":"inactive","desiredState":"loaded","name":"chef-client.service","options":[{"name":"Description","section":"Unit","value":"chef-client"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"CONTAINER=chef-client"},{"name":"SyslogIdentifier","section":"Service","value":"chef-client"},{"name":"Restart","section":"Service","value":"always"},{"name":"RestartSec","section":"Service","value":"1800"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/docker pull build.sofi.com:5000/${CONTAINER}"},{"name":"ExecStart","section":"Service","value":"/usr/bin/bash -c \"/usr/bin/docker run --rm --name ${CONTAINER} --net=host -v /data/sofi:/data/sofi -v /data/chef:/etc/chef build.sofi.com:5000/${CONTAINER}\""},{"name":"Global","section":"X-Fleet","value":"true"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"inactive","desiredState":"inactive","name":"clamav@.service","options":[{"name":"Description","section":"Unit","value":"clamav"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"clamav"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"CONTAINER=clamav"},{"name":"Environment","section":"Service","value":"EXT_PORT=3310"},{"name":"Environment","section":"Service","value":"INT_PORT=3310"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/docker pull dinkel/clamavd"},{"name":"ExecStart","section":"Service","value":"-/bin/bash -c '      /usr/bin/docker run --rm --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/sofi/apps/conf:/config          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          dinkel/clamavd'"},{"name":"ExecStop","section":"Service","value":"-/usr/bin/docker stop ${CONTAINER}"},{"name":"ExecStop","section":"Service","value":"-/usr/bin/docker rmi ${CONTAINER}"},{"name":"Conflicts","section":"X-Fleet","value":"clamav*"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"launched","desiredState":"launched","machineID":"4e7a7efc243d440fa399ffe72bc8f069","name":"clamav@2.service","options":[{"name":"Description","section":"Unit","value":"clamav"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"clamav"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"CONTAINER=clamav"},{"name":"Environment","section":"Service","value":"EXT_PORT=3310"},{"name":"Environment","section":"Service","value":"INT_PORT=3310"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/docker pull dinkel/clamavd"},{"name":"ExecStart","section":"Service","value":"-/bin/bash -c '      /usr/bin/docker run --rm --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/sofi/apps/conf:/config          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          dinkel/clamavd'"},{"name":"ExecStop","section":"Service","value":"-/usr/bin/docker stop ${CONTAINER}"},{"name":"ExecStop","section":"Service","value":"-/usr/bin/docker rmi ${CONTAINER}"},{"name":"Conflicts","section":"X-Fleet","value":"clamav*"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"inactive","desiredState":"inactive","name":"collateral@.service","options":[{"name":"Description","section":"Unit","value":"collateral app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"collateral"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"EnvironmentFile","section":"Service","value":"/shared/config/vault.env"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/sofi-collateral"},{"name":"Environment","section":"Service","value":"CONTAINER=collateral"},{"name":"Environment","section":"Service","value":"EXT_PORT=9021"},{"name":"Environment","section":"Service","value":"INT_PORT=9000"},{"name":"Environment","section":"Service","value":"CONTEXT=z/"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/newrelic:/data/newrelic          -v /shared:/shared          -e NODE_IP=\"${COREOS_PRIVATE_IPV4}\"          -e HOSTNAME=\"%H\"          -e VAULT_ADDR=\"http://active.vault.service.consul:8200\"          -e VAULT_TOKEN=\"${VAULT_TOKEN}\"          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/${CONTEXT} | grep HTTP | grep 200 || exit 255\"          -e NEW_RELIC_APP_NAME=\"${CONTAINER} (${ENV})\"          -e NEW_RELIC_HOST_DISPLAY_NAME=\"%H\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i; sleep 15;'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"Conflicts","section":"X-Fleet","value":"collateral*"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"launched","desiredState":"launched","machineID":"6a9f464f4a24454394aacc383cce0086","name":"collateral@2.service","options":[{"name":"Description","section":"Unit","value":"collateral app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"collateral"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"EnvironmentFile","section":"Service","value":"/shared/config/vault.env"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/sofi-collateral"},{"name":"Environment","section":"Service","value":"CONTAINER=collateral"},{"name":"Environment","section":"Service","value":"EXT_PORT=9021"},{"name":"Environment","section":"Service","value":"INT_PORT=9000"},{"name":"Environment","section":"Service","value":"CONTEXT=z/"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/newrelic:/data/newrelic          -v /shared:/shared          -e NODE_IP=\"${COREOS_PRIVATE_IPV4}\"          -e HOSTNAME=\"%H\"          -e VAULT_ADDR=\"http://active.vault.service.consul:8200\"          -e VAULT_TOKEN=\"${VAULT_TOKEN}\"          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/${CONTEXT} | grep HTTP | grep 200 || exit 255\"          -e NEW_RELIC_APP_NAME=\"${CONTAINER} (${ENV})\"          -e NEW_RELIC_HOST_DISPLAY_NAME=\"%H\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i; sleep 15;'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"Conflicts","section":"X-Fleet","value":"collateral*"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"inactive","desiredState":"inactive","name":"comments@.service","options":[{"name":"Description","section":"Unit","value":"comments app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"comments"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"EnvironmentFile","section":"Service","value":"/shared/config/vault.env"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/sofi-comments"},{"name":"Environment","section":"Service","value":"CONTAINER=comments"},{"name":"Environment","section":"Service","value":"BRANCH=master"},{"name":"Environment","section":"Service","value":"EXT_PORT=9015"},{"name":"Environment","section":"Service","value":"INT_PORT=3000"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/newrelic:/data/newrelic          -e HOSTNAME=\"%H\"          -e NODE_IP=\"${COREOS_PRIVATE_IPV4}\"          -e VAULT_ADDR=\"http://active.vault.service.consul:8200\"          -e VAULT_TOKEN=\"${VAULT_TOKEN}\"          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/ | grep HTTP | grep 200 || exit 255\"          -e NEW_RELIC_APP_NAME=\"${CONTAINER} (${ENV})\"          -e NEW_RELIC_HOST_DISPLAY_NAME=\"%H\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i; sleep 15;'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"Conflicts","section":"X-Fleet","value":"comments@*.service"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"launched","desiredState":"launched","machineID":"8347693a19394ab58867d3863eec5581","name":"comments@1.service","options":[{"name":"Description","section":"Unit","value":"comments app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"comments"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"EnvironmentFile","section":"Service","value":"/shared/config/vault.env"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/sofi-comments"},{"name":"Environment","section":"Service","value":"CONTAINER=comments"},{"name":"Environment","section":"Service","value":"BRANCH=master"},{"name":"Environment","section":"Service","value":"EXT_PORT=9015"},{"name":"Environment","section":"Service","value":"INT_PORT=3000"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/newrelic:/data/newrelic          -e HOSTNAME=\"%H\"          -e NODE_IP=\"${COREOS_PRIVATE_IPV4}\"          -e VAULT_ADDR=\"http://active.vault.service.consul:8200\"          -e VAULT_TOKEN=\"${VAULT_TOKEN}\"          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/ | grep HTTP | grep 200 || exit 255\"          -e NEW_RELIC_APP_NAME=\"${CONTAINER} (${ENV})\"          -e NEW_RELIC_HOST_DISPLAY_NAME=\"%H\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i; sleep 15;'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"Conflicts","section":"X-Fleet","value":"comments@*.service"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"launched","desiredState":"launched","machineID":"279088ab82e84f2d85fa789b89e60cf7","name":"comments@2.service","options":[{"name":"Description","section":"Unit","value":"comments app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"comments"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"EnvironmentFile","section":"Service","value":"/shared/config/vault.env"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/sofi-comments"},{"name":"Environment","section":"Service","value":"CONTAINER=comments"},{"name":"Environment","section":"Service","value":"BRANCH=master"},{"name":"Environment","section":"Service","value":"EXT_PORT=9015"},{"name":"Environment","section":"Service","value":"INT_PORT=3000"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/newrelic:/data/newrelic          -e HOSTNAME=\"%H\"          -e NODE_IP=\"${COREOS_PRIVATE_IPV4}\"          -e VAULT_ADDR=\"http://active.vault.service.consul:8200\"          -e VAULT_TOKEN=\"${VAULT_TOKEN}\"          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/ | grep HTTP | grep 200 || exit 255\"          -e NEW_RELIC_APP_NAME=\"${CONTAINER} (${ENV})\"          -e NEW_RELIC_HOST_DISPLAY_NAME=\"%H\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i; sleep 15;'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"Conflicts","section":"X-Fleet","value":"comments@*.service"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"inactive","desiredState":"launched","name":"consul-agent.service","options":[{"name":"Description","section":"Unit","value":"Consul Agent"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"Before","section":"Unit","value":"users-cloudconfig.service"},{"name":"SyslogIdentifier","section":"Service","value":"consul"},{"name":"Restart","section":"Service","value":"always"},{"name":"RestartSec","section":"Service","value":"10"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"CONTAINER=consul"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=gliderlabs/consul-agent"},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/consul-agent/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/bin/bash -c 'rm /etc/systemd/resolved.conf.d/00-consul-dns.conf'"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/mkdir -p /etc/systemd/resolved.conf.d"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c 'systemctl restart systemd-resolved'"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"-/bin/bash -c '      NODE_NAME=\"$(/usr/bin/uuidgen)\";      CONSUL_ARGS=\"\";      for i in $(etcdctl ls /consul/nodes/); do        CONSUL_ARGS=\"$CONSUL_ARGS -join $(etcdctl get $i)\";      done;      /usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":8300:8300          -p \"${COREOS_PRIVATE_IPV4}\":8301:8301          -p \"${COREOS_PRIVATE_IPV4}\":8301:8301/udp          -p \"${COREOS_PRIVATE_IPV4}\":8302:8302          -p \"${COREOS_PRIVATE_IPV4}\":8302:8302/udp          -p \"${COREOS_PRIVATE_IPV4}\":8400:8400          -p \"${COREOS_PRIVATE_IPV4}\":8500:8500          -p \"${COREOS_PRIVATE_IPV4}\":53:8600/udp          ${DOCKER_REPO}:${TAG} -advertise ${COREOS_PRIVATE_IPV4} -node=\"%H\" -recursor 10.0.0.2 $CONSUL_ARGS;'"},{"name":"ExecStartPost","section":"Service","value":"/bin/bash -c 'echo -e \"[Resolve]\\nDNS=${COREOS_PRIVATE_IPV4}\" > /etc/systemd/resolved.conf.d/00-consul-dns.conf && systemctl restart systemd-resolved'"},{"name":"ExecStartPost","section":"Service","value":"-/bin/bash -c 'sudo systemctl restart registrator.service'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c 'rm /etc/systemd/resolved.conf.d/00-consul-dns.conf && systemctl restart systemd-resolved'"},{"name":"ExecStop","section":"Service","value":"/usr/bin/docker exec ${CONTAINER} consul leave"},{"name":"ExecStop","section":"Service","value":"/usr/bin/docker stop ${CONTAINER}"},{"name":"ExecStopPost","section":"Service","value":"/usr/bin/docker run --net=host --privileged --rm cap10morgan/conntrack -F"},{"name":"Global","section":"X-Fleet","value":"true"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=infra"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=web"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=intweb"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=es"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=es-app"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=infra"}]},{"currentState":"inactive","desiredState":"inactive","name":"consul-backup@.service","options":[{"name":"Description","section":"Unit","value":"Consul Backup"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"consul-backup"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"EnvironmentFile","section":"Service","value":"/shared/config/vault.env"},{"name":"Environment","section":"Service","value":"CONTAINER=consul-backup"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/consul-backup"},{"name":"Environment","section":"Service","value":"\"ETCD_HOST=$(etcdctl get /etcdhost)\""},{"name":"Environment","section":"Service","value":"BUCKET=consul.backup.sofi.com"},{"name":"Environment","section":"Service","value":"\"BUCKET_KEY=$(etcdctl get /environment)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}'"},{"name":"ExecStart","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker run --rm --name ${CONTAINER} -h %H          -e ETCD_HOST=\"${ETCD_HOST}\"          -e BUCKET=\"${BUCKET}\"          -e BUCKET_KEY=\"${BUCKET_KEY}\"          -e AWS_ACCESS_KEY=$(curl -s -X GET -H \"X-Vault-Token: ${VAULT_TOKEN}\" ${VAULT_ADDR}v1/secret/service/s3/backup | jq -r .data.access_key)          -e AWS_SECRET_ACCESS_KEY=$(curl -s -X GET -H \"X-Vault-Token: ${VAULT_TOKEN}\" ${VAULT_ADDR}v1/secret/service/s3/backup | jq -r .data.secret_key)          ${DOCKER_REPO}'"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=infra"},{"name":"Conflicts","section":"X-Fleet","value":"consul-backup@*.service"}]},{"currentState":"inactive","desiredState":"inactive","name":"consul-backup@.timer","options":[{"name":"Description","section":"Unit","value":"Run consul-backup service every day"},{"name":"OnCalendar","section":"Timer","value":"daily"},{"name":"Unit","section":"Timer","value":"%p@%i.service"},{"name":"WantedBy","section":"Install","value":"timers.target"},{"name":"MachineOf","section":"X-Fleet","value":"%p@%i.service"}]},{"currentState":"launched","desiredState":"launched","machineID":"5a2124ac313e4008824cefacf90db0b4","name":"consul-backup@1.service","options":[{"name":"Description","section":"Unit","value":"Consul Backup"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"consul-backup"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"EnvironmentFile","section":"Service","value":"/shared/config/vault.env"},{"name":"Environment","section":"Service","value":"CONTAINER=consul-backup"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/consul-backup"},{"name":"Environment","section":"Service","value":"\"ETCD_HOST=$(etcdctl get /etcdhost)\""},{"name":"Environment","section":"Service","value":"BUCKET=consul.backup.sofi.com"},{"name":"Environment","section":"Service","value":"\"BUCKET_KEY=$(etcdctl get /environment)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}'"},{"name":"ExecStart","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker run --rm --name ${CONTAINER} -h %H          -e ETCD_HOST=\"${ETCD_HOST}\"          -e BUCKET=\"${BUCKET}\"          -e BUCKET_KEY=\"${BUCKET_KEY}\"          -e AWS_ACCESS_KEY=$(curl -s -X GET -H \"X-Vault-Token: ${VAULT_TOKEN}\" ${VAULT_ADDR}v1/secret/service/s3/backup | jq -r .data.access_key)          -e AWS_SECRET_ACCESS_KEY=$(curl -s -X GET -H \"X-Vault-Token: ${VAULT_TOKEN}\" ${VAULT_ADDR}v1/secret/service/s3/backup | jq -r .data.secret_key)          ${DOCKER_REPO}'"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=infra"},{"name":"Conflicts","section":"X-Fleet","value":"consul-backup@*.service"}]},{"currentState":"inactive","desiredState":"inactive","name":"consul-backup@1.timer","options":[{"name":"Description","section":"Unit","value":"Run consul-backup service every day"},{"name":"OnCalendar","section":"Timer","value":"daily"},{"name":"Unit","section":"Timer","value":"%p@%i.service"},{"name":"WantedBy","section":"Install","value":"timers.target"},{"name":"MachineOf","section":"X-Fleet","value":"%p@%i.service"}]},{"currentState":"inactive","desiredState":"inactive","name":"consul-monitor@.service","options":[{"name":"Description","section":"Unit","value":"Consul Service Check"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"consul-monitor-test"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"CONTAINER=consul-monitor-test"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/consul-monitor-test"},{"name":"Environment","section":"Service","value":"THRESHOLD=3"},{"name":"Environment","section":"Service","value":"RECURRENCE=2"},{"name":"Environment","section":"Service","value":"\"ETCD_HOST=$(etcdctl get /etcdhost)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}'"},{"name":"ExecStart","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker run --rm --name ${CONTAINER} -h %H          -e ETCD_HOST=\"${ETCD_HOST}\"          -e THRESHOLD=\"${THRESHOLD}\"          -e RECURRENCE=\"${RECURRENCE}\"          ${DOCKER_REPO}'"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"},{"name":"Conflicts","section":"X-Fleet","value":"consul-monitor-test@*.service"}]},{"currentState":"inactive","desiredState":"inactive","name":"consul-server@.service","options":[{"name":"Description","section":"Unit","value":"Consul Master"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"consul"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"CONTAINER=consul"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=gliderlabs/consul-server"},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/consul-server/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/mkdir -p /etc/systemd/resolved.conf.d"},{"name":"ExecStartPre","section":"Service","value":"-/bin/bash -c 'rm /etc/systemd/resolved.conf.d/00-consul-dns.conf && systemctl restart systemd-resolved'"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c 'docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"-/bin/bash -c '      NODE_NAME=$(/usr/bin/uuidgen);      CONSUL_ARGS=\"\";      for i in $(etcdctl ls /consul/nodes/); do        CONSUL_ARGS=\"$CONSUL_ARGS -join $(etcdctl get $i)\";      done;      CLUSTER_COUNT=$(etcdctl ls /consul/nodes/ | wc -l);      BOOTSTRAP_EXPECT=$(etcdctl get /consul/bootstrap-expect);      BOOTSTRAP_ARGS=\"\";      if [ $(etcdctl get /consul/bootstrapped) -lt $BOOTSTRAP_EXPECT ];      \tthen BOOTSTRAP_ARGS=\"-bootstrap-expect $BOOTSTRAP_EXPECT\";      fi;      echo \"BOOTSTRAP_ARGS ARE ($BOOTSTRAP_ARGS)\";      /usr/bin/docker run --rm --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":8300:8300          -p \"${COREOS_PRIVATE_IPV4}\":8301:8301          -p \"${COREOS_PRIVATE_IPV4}\":8301:8301/udp          -p \"${COREOS_PRIVATE_IPV4}\":8302:8302          -p \"${COREOS_PRIVATE_IPV4}\":8302:8302/udp          -p \"${COREOS_PRIVATE_IPV4}\":8400:8400          -p \"${COREOS_PRIVATE_IPV4}\":8500:8500          -p \"${COREOS_PRIVATE_IPV4}\":8600:8600          -p \"${COREOS_PRIVATE_IPV4}\":8600:8600/udp          -p \"${COREOS_PRIVATE_IPV4}\":53:8600/udp          ${DOCKER_REPO}:${TAG} -server -node=\"%H\" -recursor 10.0.0.2 $BOOTSTRAP_ARGS -advertise ${COREOS_PRIVATE_IPV4} $CONSUL_ARGS  '"},{"name":"ExecStartPost","section":"Service","value":"/bin/bash -c 'echo -e \"[Resolve]\\nDNS=${COREOS_PRIVATE_IPV4}\"> /etc/systemd/resolved.conf.d/00-consul-dns.conf && systemctl restart systemd-resolved; cat /etc/systemd/resolved.conf.d/00-consul-dns.conf;'"},{"name":"ExecStartPost","section":"Service","value":"/bin/bash -c '  \tif [ $(etcdctl get /consul/boostrapped) -lt $(etcdctl get /consul/bootstrap-expect) ];  \t\tthen etcdctl set /consul/bootstrapped $(expr $(etcdctl get /consul/bootstrapped) + 1)';  \tfi'"},{"name":"ExecStop","section":"Service","value":"-/usr/bin/docker exec ${CONTAINER} consul leave"},{"name":"ExecStop","section":"Service","value":"/usr/bin/docker stop ${CONTAINER}"},{"name":"ExecStop","section":"Service","value":"-/usr/bin/docker rmi ${CONTAINER}"},{"name":"ExecStopPost","section":"Service","value":"/bin/bash -c 'rm /etc/systemd/resolved.conf.d/00-consul-dns.conf && systemctl restart systemd-resolved'"},{"name":"ExecStopPost","section":"Service","value":"/usr/bin/docker run --net=host --privileged --rm cap10morgan/conntrack -F"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=etcd"},{"name":"Conflicts","section":"X-Fleet","value":"consul*"}]},{"currentState":"launched","desiredState":"launched","machineID":"33fe32405eb44b568acbd72765c4d443","name":"consul-server@1.service","options":[{"name":"Description","section":"Unit","value":"Consul Master"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"consul"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"CONTAINER=consul"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=gliderlabs/consul-server"},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/consul-server/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/mkdir -p /etc/systemd/resolved.conf.d"},{"name":"ExecStartPre","section":"Service","value":"-/bin/bash -c 'rm /etc/systemd/resolved.conf.d/00-consul-dns.conf && systemctl restart systemd-resolved'"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c 'docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"-/bin/bash -c '      NODE_NAME=$(/usr/bin/uuidgen);      CONSUL_ARGS=\"\";      for i in $(etcdctl ls /consul/nodes/); do        CONSUL_ARGS=\"$CONSUL_ARGS -join $(etcdctl get $i)\";      done;      CLUSTER_COUNT=$(etcdctl ls /consul/nodes/ | wc -l);      BOOTSTRAP_EXPECT=$(etcdctl get /consul/bootstrap-expect);      BOOTSTRAP_ARGS=\"\";      if [ $(etcdctl get /consul/bootstrapped) -lt $BOOTSTRAP_EXPECT ];      \tthen BOOTSTRAP_ARGS=\"-bootstrap-expect $BOOTSTRAP_EXPECT\";      fi;      echo \"BOOTSTRAP_ARGS ARE ($BOOTSTRAP_ARGS)\";      /usr/bin/docker run --rm --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":8300:8300          -p \"${COREOS_PRIVATE_IPV4}\":8301:8301          -p \"${COREOS_PRIVATE_IPV4}\":8301:8301/udp          -p \"${COREOS_PRIVATE_IPV4}\":8302:8302          -p \"${COREOS_PRIVATE_IPV4}\":8302:8302/udp          -p \"${COREOS_PRIVATE_IPV4}\":8400:8400          -p \"${COREOS_PRIVATE_IPV4}\":8500:8500          -p \"${COREOS_PRIVATE_IPV4}\":8600:8600          -p \"${COREOS_PRIVATE_IPV4}\":8600:8600/udp          -p \"${COREOS_PRIVATE_IPV4}\":53:8600/udp          ${DOCKER_REPO}:${TAG} -server -node=\"%H\" -recursor 10.0.0.2 $BOOTSTRAP_ARGS -advertise ${COREOS_PRIVATE_IPV4} $CONSUL_ARGS  '"},{"name":"ExecStartPost","section":"Service","value":"/bin/bash -c 'echo -e \"[Resolve]\\nDNS=${COREOS_PRIVATE_IPV4}\"> /etc/systemd/resolved.conf.d/00-consul-dns.conf && systemctl restart systemd-resolved; cat /etc/systemd/resolved.conf.d/00-consul-dns.conf;'"},{"name":"ExecStartPost","section":"Service","value":"/bin/bash -c '  \tif [ $(etcdctl get /consul/boostrapped) -lt $(etcdctl get /consul/bootstrap-expect) ];  \t\tthen etcdctl set /consul/bootstrapped $(expr $(etcdctl get /consul/bootstrapped) + 1)';  \tfi'"},{"name":"ExecStop","section":"Service","value":"-/usr/bin/docker exec ${CONTAINER} consul leave"},{"name":"ExecStop","section":"Service","value":"/usr/bin/docker stop ${CONTAINER}"},{"name":"ExecStop","section":"Service","value":"-/usr/bin/docker rmi ${CONTAINER}"},{"name":"ExecStopPost","section":"Service","value":"/bin/bash -c 'rm /etc/systemd/resolved.conf.d/00-consul-dns.conf && systemctl restart systemd-resolved'"},{"name":"ExecStopPost","section":"Service","value":"/usr/bin/docker run --net=host --privileged --rm cap10morgan/conntrack -F"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=etcd"},{"name":"Conflicts","section":"X-Fleet","value":"consul*"}]},{"currentState":"launched","desiredState":"launched","machineID":"6459c757a4314e069c836d23c4ed13de","name":"consul-server@2.service","options":[{"name":"Description","section":"Unit","value":"Consul Master"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"consul"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"CONTAINER=consul"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=gliderlabs/consul-server"},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/consul-server/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/mkdir -p /etc/systemd/resolved.conf.d"},{"name":"ExecStartPre","section":"Service","value":"-/bin/bash -c 'rm /etc/systemd/resolved.conf.d/00-consul-dns.conf && systemctl restart systemd-resolved'"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c 'docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"-/bin/bash -c '      NODE_NAME=$(/usr/bin/uuidgen);      CONSUL_ARGS=\"\";      for i in $(etcdctl ls /consul/nodes/); do        CONSUL_ARGS=\"$CONSUL_ARGS -join $(etcdctl get $i)\";      done;      CLUSTER_COUNT=$(etcdctl ls /consul/nodes/ | wc -l);      BOOTSTRAP_EXPECT=$(etcdctl get /consul/bootstrap-expect);      BOOTSTRAP_ARGS=\"\";      if [ $(etcdctl get /consul/bootstrapped) -lt $BOOTSTRAP_EXPECT ];      \tthen BOOTSTRAP_ARGS=\"-bootstrap-expect $BOOTSTRAP_EXPECT\";      fi;      echo \"BOOTSTRAP_ARGS ARE ($BOOTSTRAP_ARGS)\";      /usr/bin/docker run --rm --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":8300:8300          -p \"${COREOS_PRIVATE_IPV4}\":8301:8301          -p \"${COREOS_PRIVATE_IPV4}\":8301:8301/udp          -p \"${COREOS_PRIVATE_IPV4}\":8302:8302          -p \"${COREOS_PRIVATE_IPV4}\":8302:8302/udp          -p \"${COREOS_PRIVATE_IPV4}\":8400:8400          -p \"${COREOS_PRIVATE_IPV4}\":8500:8500          -p \"${COREOS_PRIVATE_IPV4}\":8600:8600          -p \"${COREOS_PRIVATE_IPV4}\":8600:8600/udp          -p \"${COREOS_PRIVATE_IPV4}\":53:8600/udp          ${DOCKER_REPO}:${TAG} -server -node=\"%H\" -recursor 10.0.0.2 $BOOTSTRAP_ARGS -advertise ${COREOS_PRIVATE_IPV4} $CONSUL_ARGS  '"},{"name":"ExecStartPost","section":"Service","value":"/bin/bash -c 'echo -e \"[Resolve]\\nDNS=${COREOS_PRIVATE_IPV4}\"> /etc/systemd/resolved.conf.d/00-consul-dns.conf && systemctl restart systemd-resolved; cat /etc/systemd/resolved.conf.d/00-consul-dns.conf;'"},{"name":"ExecStartPost","section":"Service","value":"/bin/bash -c '  \tif [ $(etcdctl get /consul/boostrapped) -lt $(etcdctl get /consul/bootstrap-expect) ];  \t\tthen etcdctl set /consul/bootstrapped $(expr $(etcdctl get /consul/bootstrapped) + 1)';  \tfi'"},{"name":"ExecStop","section":"Service","value":"-/usr/bin/docker exec ${CONTAINER} consul leave"},{"name":"ExecStop","section":"Service","value":"/usr/bin/docker stop ${CONTAINER}"},{"name":"ExecStop","section":"Service","value":"-/usr/bin/docker rmi ${CONTAINER}"},{"name":"ExecStopPost","section":"Service","value":"/bin/bash -c 'rm /etc/systemd/resolved.conf.d/00-consul-dns.conf && systemctl restart systemd-resolved'"},{"name":"ExecStopPost","section":"Service","value":"/usr/bin/docker run --net=host --privileged --rm cap10morgan/conntrack -F"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=etcd"},{"name":"Conflicts","section":"X-Fleet","value":"consul*"}]},{"currentState":"launched","desiredState":"launched","machineID":"1f5f45738f884a31abc45eac3c4aadf0","name":"consul-server@3.service","options":[{"name":"Description","section":"Unit","value":"Consul Master"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"consul"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"CONTAINER=consul"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=gliderlabs/consul-server"},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/consul-server/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/mkdir -p /etc/systemd/resolved.conf.d"},{"name":"ExecStartPre","section":"Service","value":"-/bin/bash -c 'rm /etc/systemd/resolved.conf.d/00-consul-dns.conf && systemctl restart systemd-resolved'"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c 'docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"-/bin/bash -c '      NODE_NAME=$(/usr/bin/uuidgen);      CONSUL_ARGS=\"\";      for i in $(etcdctl ls /consul/nodes/); do        CONSUL_ARGS=\"$CONSUL_ARGS -join $(etcdctl get $i)\";      done;      CLUSTER_COUNT=$(etcdctl ls /consul/nodes/ | wc -l);      BOOTSTRAP_EXPECT=$(etcdctl get /consul/bootstrap-expect);      BOOTSTRAP_ARGS=\"\";      if [ $(etcdctl get /consul/bootstrapped) -lt $BOOTSTRAP_EXPECT ];      \tthen BOOTSTRAP_ARGS=\"-bootstrap-expect $BOOTSTRAP_EXPECT\";      fi;      echo \"BOOTSTRAP_ARGS ARE ($BOOTSTRAP_ARGS)\";      /usr/bin/docker run --rm --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":8300:8300          -p \"${COREOS_PRIVATE_IPV4}\":8301:8301          -p \"${COREOS_PRIVATE_IPV4}\":8301:8301/udp          -p \"${COREOS_PRIVATE_IPV4}\":8302:8302          -p \"${COREOS_PRIVATE_IPV4}\":8302:8302/udp          -p \"${COREOS_PRIVATE_IPV4}\":8400:8400          -p \"${COREOS_PRIVATE_IPV4}\":8500:8500          -p \"${COREOS_PRIVATE_IPV4}\":8600:8600          -p \"${COREOS_PRIVATE_IPV4}\":8600:8600/udp          -p \"${COREOS_PRIVATE_IPV4}\":53:8600/udp          ${DOCKER_REPO}:${TAG} -server -node=\"%H\" -recursor 10.0.0.2 $BOOTSTRAP_ARGS -advertise ${COREOS_PRIVATE_IPV4} $CONSUL_ARGS  '"},{"name":"ExecStartPost","section":"Service","value":"/bin/bash -c 'echo -e \"[Resolve]\\nDNS=${COREOS_PRIVATE_IPV4}\"> /etc/systemd/resolved.conf.d/00-consul-dns.conf && systemctl restart systemd-resolved; cat /etc/systemd/resolved.conf.d/00-consul-dns.conf;'"},{"name":"ExecStartPost","section":"Service","value":"/bin/bash -c '  \tif [ $(etcdctl get /consul/boostrapped) -lt $(etcdctl get /consul/bootstrap-expect) ];  \t\tthen etcdctl set /consul/bootstrapped $(expr $(etcdctl get /consul/bootstrapped) + 1)';  \tfi'"},{"name":"ExecStop","section":"Service","value":"-/usr/bin/docker exec ${CONTAINER} consul leave"},{"name":"ExecStop","section":"Service","value":"/usr/bin/docker stop ${CONTAINER}"},{"name":"ExecStop","section":"Service","value":"-/usr/bin/docker rmi ${CONTAINER}"},{"name":"ExecStopPost","section":"Service","value":"/bin/bash -c 'rm /etc/systemd/resolved.conf.d/00-consul-dns.conf && systemctl restart systemd-resolved'"},{"name":"ExecStopPost","section":"Service","value":"/usr/bin/docker run --net=host --privileged --rm cap10morgan/conntrack -F"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=etcd"},{"name":"Conflicts","section":"X-Fleet","value":"consul*"}]},{"currentState":"inactive","desiredState":"launched","name":"coreos-info.service","options":[{"name":"Description","section":"Unit","value":"coreos release info"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"SyslogIdentifier","section":"Service","value":"coreos-info"},{"name":"Restart","section":"Service","value":"always"},{"name":"RestartSec","section":"Service","value":"10800s"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c \"etcdctl set /coreos/$$COREOS_PRIVATE_IPV4/release/hostname $(hostname); while read -r line || [ -n \\\"$$line\\\" ]; do key=$(echo $line | awk -F= '{print tolower($1)}'); value=$(echo $line | cut -d= -f2- | sed -e 's/^\\\"//g' | sed -e 's/\\\"$//g'); etcdctl set /coreos/$$COREOS_PRIVATE_IPV4/release/$$key \\\"$$value\\\"; done < /etc/os-release\""},{"name":"Global","section":"X-Fleet","value":"true"}]},{"currentState":"inactive","desiredState":"inactive","name":"credit-reporting@.service","options":[{"name":"Description","section":"Unit","value":"credit-reporting app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"credit-reporting"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"EnvironmentFile","section":"Service","value":"/shared/config/vault.env"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/credit-reporting"},{"name":"Environment","section":"Service","value":"CONTAINER=credit-reporting"},{"name":"Environment","section":"Service","value":"EXT_PORT=9039"},{"name":"Environment","section":"Service","value":"INT_PORT=9039"},{"name":"Environment","section":"Service","value":"CONTEXT=cr/"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/newrelic:/data/newrelic          -e NODE_IP=\"${COREOS_PRIVATE_IPV4}\"          -e HOSTNAME=\"%H\"          -e VAULT_ADDR=\"http://active.vault.service.consul:8200\"          -e VAULT_TOKEN=\"${VAULT_TOKEN}\"          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_HTTP=\"/${CONTEXT}\"          -e SERVICE_CHECK_INTERVAL=\"10s\"          -e NEW_RELIC_APP_NAME=\"${CONTAINER} (${ENV})\"          -e NEW_RELIC_HOST_DISPLAY_NAME=\"%H\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"Conflicts","section":"X-Fleet","value":"credit-reporting*"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"launched","desiredState":"launched","machineID":"4e7a7efc243d440fa399ffe72bc8f069","name":"credit-reporting@2.service","options":[{"name":"Description","section":"Unit","value":"credit-reporting app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"credit-reporting"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"EnvironmentFile","section":"Service","value":"/shared/config/vault.env"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/credit-reporting"},{"name":"Environment","section":"Service","value":"CONTAINER=credit-reporting"},{"name":"Environment","section":"Service","value":"EXT_PORT=9039"},{"name":"Environment","section":"Service","value":"INT_PORT=9039"},{"name":"Environment","section":"Service","value":"CONTEXT=cr/"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/newrelic:/data/newrelic          -e NODE_IP=\"${COREOS_PRIVATE_IPV4}\"          -e HOSTNAME=\"%H\"          -e VAULT_ADDR=\"http://active.vault.service.consul:8200\"          -e VAULT_TOKEN=\"${VAULT_TOKEN}\"          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_HTTP=\"/${CONTEXT}\"          -e SERVICE_CHECK_INTERVAL=\"10s\"          -e NEW_RELIC_APP_NAME=\"${CONTAINER} (${ENV})\"          -e NEW_RELIC_HOST_DISPLAY_NAME=\"%H\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"Conflicts","section":"X-Fleet","value":"credit-reporting*"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"inactive","desiredState":"inactive","name":"crubackup@.service","options":[{"name":"Description","section":"Unit","value":"crucible Snapshot Service"},{"name":"Type","section":"Service","value":"simple"},{"name":"SyslogIdentifier","section":"Service","value":"crucible-snapshot"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"EnvironmentFile","section":"Service","value":"/data/sofi/apps/conf/crucible.env"},{"name":"Environment","section":"Service","value":"\"NOW=$(/bin/date +%%Y%%m%%d-%%H%%M%%S)\""},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      echo \"Syncing to ${BUCKET}: ${NOW}\";      docker exec crucible /usr/bin/aws s3 sync /data/crucible-data/ s3://${BUCKET}/ '"},{"name":"MachineOf","section":"X-Fleet","value":"crucible@%i.service"}]},{"currentState":"inactive","desiredState":"inactive","name":"crubackup@.timer","options":[{"name":"Description","section":"Unit","value":"Run crubackup service hourly"},{"name":"OnCalendar","section":"Timer","value":"*:0/5"},{"name":"Unit","section":"Timer","value":"%p@%i.service"},{"name":"WantedBy","section":"Install","value":"timers.target"},{"name":"MachineOf","section":"X-Fleet","value":"%p@%i.service"}]},{"currentState":"inactive","desiredState":"inactive","name":"crucible@.service","options":[{"name":"Description","section":"Unit","value":"crucible app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"crucible"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"CONTAINER=crucible"},{"name":"Environment","section":"Service","value":"/bin/bash -c \"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"Environment","section":"Service","value":"EXT_PORT=9043"},{"name":"Environment","section":"Service","value":"INT_PORT=8060"},{"name":"Environment","section":"Service","value":"CONTEXT=crucible/"},{"name":"EnvironmentFile","section":"Service","value":"/data/sofi/apps/conf/crucible.env"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/docker pull build.sofi.com:5000/${CONTAINER}:${TAG}"},{"name":"ExecStart","section":"Service","value":"-/bin/bash -c '      \t/usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -k -s -I http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/crucible/ | grep HTTP | grep 200 || exit 255\"          --env-file=/data/sofi/apps/conf/crucible.env          --privileged=True          build.sofi.com:5000/${CONTAINER}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i;'"},{"name":"ExecStop","section":"Service","value":"-/usr/bin/docker stop ${CONTAINER}"},{"name":"ExecStop","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStop","section":"Service","value":"-/usr/bin/docker rmi build.sofi.com:5000/${CONTAINER}:${TAG}"},{"name":"Conflicts","section":"X-Fleet","value":"crucible*"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"inactive","desiredState":"inactive","name":"curator@.service","options":[{"name":"Description","section":"Unit","value":"Curator elasticsearch utility for elastic-logs cluster indice cleanup"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"curator"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"EnvironmentFile","section":"Service","value":"/shared/config/vault.env"},{"name":"Environment","section":"Service","value":"CONTAINER=curator"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/curator"},{"name":"Environment","section":"Service","value":"CLUSTER_ID=elastic-logs"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}'"},{"name":"ExecStart","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker run --rm --name ${CONTAINER} -h %H          -e CONSUL_HOST=\"${COREOS_PRIVATE_IPV4}:8500\"          -e CLUSTER_ID=\"${CLUSTER_ID}\"          ${DOCKER_REPO}'"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=infra"},{"name":"Conflicts","section":"X-Fleet","value":"curator@*.service"}]},{"currentState":"inactive","desiredState":"inactive","name":"curator@.timer","options":[{"name":"Description","section":"Unit","value":"Run daily curator service"},{"name":"OnCalendar","section":"Timer","value":"*-*-* 04:11:30"},{"name":"Unit","section":"Timer","value":"%p@%i.service"},{"name":"WantedBy","section":"Install","value":"timers.target"},{"name":"MachineOf","section":"X-Fleet","value":"%p@%i.service"}]},{"currentState":"launched","desiredState":"launched","machineID":"5a2124ac313e4008824cefacf90db0b4","name":"curator@1.service","options":[{"name":"Description","section":"Unit","value":"Curator elasticsearch utility for elastic-logs cluster indice cleanup"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"curator"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"EnvironmentFile","section":"Service","value":"/shared/config/vault.env"},{"name":"Environment","section":"Service","value":"CONTAINER=curator"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/curator"},{"name":"Environment","section":"Service","value":"CLUSTER_ID=elastic-logs"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}'"},{"name":"ExecStart","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker run --rm --name ${CONTAINER} -h %H          -e CONSUL_HOST=\"${COREOS_PRIVATE_IPV4}:8500\"          -e CLUSTER_ID=\"${CLUSTER_ID}\"          ${DOCKER_REPO}'"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=infra"},{"name":"Conflicts","section":"X-Fleet","value":"curator@*.service"}]},{"currentState":"loaded","desiredState":"loaded","machineID":"5a2124ac313e4008824cefacf90db0b4","name":"curator@1.timer","options":[{"name":"Description","section":"Unit","value":"Run daily curator service"},{"name":"OnCalendar","section":"Timer","value":"*-*-* 04:11:30"},{"name":"Unit","section":"Timer","value":"%p@%i.service"},{"name":"WantedBy","section":"Install","value":"timers.target"},{"name":"MachineOf","section":"X-Fleet","value":"%p@%i.service"}]},{"currentState":"inactive","desiredState":"inactive","name":"customers@.service","options":[{"name":"Description","section":"Unit","value":"customers"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"customers"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/customers"},{"name":"Environment","section":"Service","value":"CONTAINER=customers"},{"name":"Environment","section":"Service","value":"EXT_PORT=9024"},{"name":"Environment","section":"Service","value":"INT_PORT=9000"},{"name":"Environment","section":"Service","value":"CONTEXT=cs/"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/sofi/apps/conf:/config          -v /data/newrelic:/data/newrelic          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/${CONTEXT} | grep HTTP | grep 200 || exit 255\"          -e NEW_RELIC_APP_NAME=\"${CONTAINER} (${ENV})\"          -e NEW_RELIC_HOST_DISPLAY_NAME=\"%H\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i; sleep 15;'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"Conflicts","section":"X-Fleet","value":"customers@*.service"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"launched","desiredState":"launched","machineID":"f7ef52fc940a41c78280c8ad6138b88e","name":"customers@2.service","options":[{"name":"Description","section":"Unit","value":"customers"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"customers"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/customers"},{"name":"Environment","section":"Service","value":"CONTAINER=customers"},{"name":"Environment","section":"Service","value":"EXT_PORT=9024"},{"name":"Environment","section":"Service","value":"INT_PORT=9000"},{"name":"Environment","section":"Service","value":"CONTEXT=cs/"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/sofi/apps/conf:/config          -v /data/newrelic:/data/newrelic          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/${CONTEXT} | grep HTTP | grep 200 || exit 255\"          -e NEW_RELIC_APP_NAME=\"${CONTAINER} (${ENV})\"          -e NEW_RELIC_HOST_DISPLAY_NAME=\"%H\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i; sleep 15;'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"Conflicts","section":"X-Fleet","value":"customers@*.service"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"inactive","desiredState":"inactive","name":"devops-utils@.service","options":[{"name":"Description","section":"Unit","value":"Devops Utils App"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"devops-utils"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"EnvironmentFile","section":"Service","value":"/shared/config/vault.env"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/devops-utils"},{"name":"Environment","section":"Service","value":"CONTAINER=devops-utils"},{"name":"Environment","section":"Service","value":"EXT_PORT=9036"},{"name":"Environment","section":"Service","value":"INT_PORT=9000"},{"name":"Environment","section":"Service","value":"CONTEXT=du"},{"name":"Environment","section":"Service","value":"/bin/bash -c \"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"/bin/bash -c \"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"Environment","section":"Service","value":"/bin/bash -c \"ETCD_HOST=$(etcdctl get /etcdhost)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '  \t/usr/bin/docker run --name ${CONTAINER} -h %H  \t\t-p \"${COREOS_PRIVATE_IPV4}:${EXT_PORT}:${INT_PORT}\"  \t\t-e NODE_IP=\"${COREOS_PRIVATE_IPV4}\"  \t\t-e VAULT_ADDR=\"${VAULT_ADDR}\"  \t\t-e VAULT_TOKEN=\"${VAULT_TOKEN}\"  \t\t-e SERVICE_NAME=\"${CONTAINER}\"  \t\t-e SERVICE_ID=\"${CONTAINER}-%i\"  \t\t-e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/${CONTEXT}/ | grep HTTP | grep 200 || exit 255\"  \t\t--dns=\"${COREOS_PRIVATE_IPV4}\"  \t\t${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"Conflicts","section":"X-Fleet","value":"devops-utils@*.service"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=infra"}]},{"currentState":"launched","desiredState":"launched","machineID":"566d07a3f0594a3c8fa44f75a52416e2","name":"devops-utils@2.service","options":[{"name":"Description","section":"Unit","value":"Devops Utils App"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"devops-utils"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"EnvironmentFile","section":"Service","value":"/shared/config/vault.env"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/devops-utils"},{"name":"Environment","section":"Service","value":"CONTAINER=devops-utils"},{"name":"Environment","section":"Service","value":"EXT_PORT=9036"},{"name":"Environment","section":"Service","value":"INT_PORT=9000"},{"name":"Environment","section":"Service","value":"CONTEXT=du"},{"name":"Environment","section":"Service","value":"/bin/bash -c \"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"/bin/bash -c \"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"Environment","section":"Service","value":"/bin/bash -c \"ETCD_HOST=$(etcdctl get /etcdhost)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '  \t/usr/bin/docker run --name ${CONTAINER} -h %H  \t\t-p \"${COREOS_PRIVATE_IPV4}:${EXT_PORT}:${INT_PORT}\"  \t\t-e NODE_IP=\"${COREOS_PRIVATE_IPV4}\"  \t\t-e VAULT_ADDR=\"${VAULT_ADDR}\"  \t\t-e VAULT_TOKEN=\"${VAULT_TOKEN}\"  \t\t-e SERVICE_NAME=\"${CONTAINER}\"  \t\t-e SERVICE_ID=\"${CONTAINER}-%i\"  \t\t-e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/${CONTEXT}/ | grep HTTP | grep 200 || exit 255\"  \t\t--dns=\"${COREOS_PRIVATE_IPV4}\"  \t\t${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"Conflicts","section":"X-Fleet","value":"devops-utils@*.service"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=infra"}]},{"currentState":"inactive","desiredState":"launched","name":"docker-cleanup.service","options":[{"name":"Description","section":"Unit","value":"Docker Cleanup Service"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"SyslogIdentifier","section":"Service","value":"docker-cleanup"},{"name":"Restart","section":"Service","value":"always"},{"name":"RestartSec","section":"Service","value":"43200"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"ExecStart","section":"Service","value":"/usr/bin/bash -c \"docker images --no-trunc| grep none | awk '{print $3}' | xargs -r docker rmi\""},{"name":"Global","section":"X-Fleet","value":"true"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"inactive","desiredState":"inactive","name":"docker-reaper@.service","options":[{"name":"Description","section":"Unit","value":"Reaps Docker Images Fleet Doesn't Know About"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"docker-reaper"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"CONTAINER=docker-reaper"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/docker-reaper"},{"name":"Environment","section":"Service","value":"\"ETCD_HOST=$(etcdctl get /etcdhost)\""},{"name":"Environment","section":"Service","value":"MACHINES_TO_REAP=app"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}'"},{"name":"ExecStart","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker run --rm --name ${CONTAINER} -h %H          -e ETCD_HOST=\"${ETCD_HOST}\"          -e MACHINES_TO_REAP=\"${MACHINES_TO_REAP}\"          ${DOCKER_REPO}'"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=infra"},{"name":"Conflicts","section":"X-Fleet","value":"docker-reaper@*.service"}]},{"currentState":"inactive","desiredState":"inactive","name":"docker-reaper@.timer","options":[{"name":"Description","section":"Unit","value":"Run docker-reaper service every hour"},{"name":"OnCalendar","section":"Timer","value":"hourly"},{"name":"Unit","section":"Timer","value":"%p@%i.service"},{"name":"WantedBy","section":"Install","value":"timers.target"},{"name":"MachineOf","section":"X-Fleet","value":"%p@%i.service"}]},{"currentState":"launched","desiredState":"launched","machineID":"566d07a3f0594a3c8fa44f75a52416e2","name":"docker-reaper@1.service","options":[{"name":"Description","section":"Unit","value":"Reaps Docker Images Fleet Doesn't Know About"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"docker-reaper"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"CONTAINER=docker-reaper"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/docker-reaper"},{"name":"Environment","section":"Service","value":"\"ETCD_HOST=$(etcdctl get /etcdhost)\""},{"name":"Environment","section":"Service","value":"MACHINES_TO_REAP=app"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}'"},{"name":"ExecStart","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker run --rm --name ${CONTAINER} -h %H          -e ETCD_HOST=\"${ETCD_HOST}\"          -e MACHINES_TO_REAP=\"${MACHINES_TO_REAP}\"          ${DOCKER_REPO}'"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=infra"},{"name":"Conflicts","section":"X-Fleet","value":"docker-reaper@*.service"}]},{"currentState":"loaded","desiredState":"loaded","machineID":"566d07a3f0594a3c8fa44f75a52416e2","name":"docker-reaper@1.timer","options":[{"name":"Description","section":"Unit","value":"Run docker-reaper service every hour"},{"name":"OnCalendar","section":"Timer","value":"hourly"},{"name":"Unit","section":"Timer","value":"%p@%i.service"},{"name":"WantedBy","section":"Install","value":"timers.target"},{"name":"MachineOf","section":"X-Fleet","value":"%p@%i.service"}]},{"currentState":"inactive","desiredState":"inactive","name":"docker-registry@.service","options":[{"name":"Description","section":"Unit","value":"registry app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"registry"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"EnvironmentFile","section":"Service","value":"/shared/config/vault.env"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/sofi-registry"},{"name":"Environment","section":"Service","value":"CONTAINER=docker-registry"},{"name":"Environment","section":"Service","value":"EXT_PORT=5000"},{"name":"Environment","section":"Service","value":"INT_PORT=5000"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"-/bin/bash -c '      \t/usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":5000:5000          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e CONSUL_HOST=\"${COREOS_PRIVATE_IPV4}:8500\"          -e SERVICE_CHECK_SCRIPT=\"curl -s http://${COREOS_PRIVATE_IPV4}:2375/containers/${CONTAINER}/json | grep '\"Running\":true'\"          -e VAULT_ADDR=${VAULT_ADDR}          -e VAULT_TOKEN=${VAULT_TOKEN}          --dns=\"${COREOS_PRIVATE_IPV4}\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i;'"},{"name":"ExecStop","section":"Service","value":"-/usr/bin/docker stop ${CONTAINER}"},{"name":"ExecStop","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"Conflicts","section":"X-Fleet","value":"docker-registry@*.service"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=infra"}]},{"currentState":"launched","desiredState":"launched","machineID":"566d07a3f0594a3c8fa44f75a52416e2","name":"docker-registry@1.service","options":[{"name":"Description","section":"Unit","value":"registry app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"registry"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"EnvironmentFile","section":"Service","value":"/shared/config/vault.env"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/sofi-registry"},{"name":"Environment","section":"Service","value":"CONTAINER=docker-registry"},{"name":"Environment","section":"Service","value":"EXT_PORT=5000"},{"name":"Environment","section":"Service","value":"INT_PORT=5000"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"-/bin/bash -c '      \t/usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":5000:5000          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e CONSUL_HOST=\"${COREOS_PRIVATE_IPV4}:8500\"          -e SERVICE_CHECK_SCRIPT=\"curl -s http://${COREOS_PRIVATE_IPV4}:2375/containers/${CONTAINER}/json | grep '\"Running\":true'\"          -e VAULT_ADDR=${VAULT_ADDR}          -e VAULT_TOKEN=${VAULT_TOKEN}          --dns=\"${COREOS_PRIVATE_IPV4}\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i;'"},{"name":"ExecStop","section":"Service","value":"-/usr/bin/docker stop ${CONTAINER}"},{"name":"ExecStop","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"Conflicts","section":"X-Fleet","value":"docker-registry@*.service"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=infra"}]},{"currentState":"inactive","desiredState":"inactive","name":"docmagic-esign@.service","options":[{"name":"Description","section":"Unit","value":"docmagic-esign app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"docmagic-esign"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"EnvironmentFile","section":"Service","value":"/shared/config/vault.env"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/docmagic-esign"},{"name":"Environment","section":"Service","value":"CONTAINER=docmagic-esign"},{"name":"Environment","section":"Service","value":"EXT_PORT=9047"},{"name":"Environment","section":"Service","value":"INT_PORT=9047"},{"name":"Environment","section":"Service","value":"CONTEXT=esign/"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/newrelic:/data/newrelic          -e NODE_IP_ADDR=${COREOS_PRIVATE_IPV4}          -e DB_URL=jdbc:postgresql://$(curl -s http://${COREOS_PRIVATE_IPV4}:8500/v1/catalog/service/postgres-common | jq -r .[].Address):$(curl -s http://${COREOS_PRIVATE_IPV4}:8500/v1/catalog/service/postgres-common | jq -r .[].ServicePort)/sofi_com          -e DB_USER=$(curl -v -H \"X-Vault-Token: ${VAULT_TOKEN}\" ${VAULT_ADDR}v1/secret/db/common | jq -r .data.username)          -e DB_PASS=$(curl -v -H \"X-Vault-Token: ${VAULT_TOKEN}\" ${VAULT_ADDR}v1/secret/db/common | jq -r .data.password)          -e DOCMAGIC_USER=$(curl -v -H \"X-Vault-Token: ${VAULT_TOKEN}\" ${VAULT_ADDR}v1/secret/service/docmagic | jq -r .data.username)          -e DOCMAGIC_PASS=$(curl -v -H \"X-Vault-Token: ${VAULT_TOKEN}\" ${VAULT_ADDR}v1/secret/service/docmagic | jq -r .data.password)          -e DOCMAGIC_ID=$(curl -s http://${COREOS_PRIVATE_IPV4}:8500/v1/kv/service/docmagic/id | jq -r .[].Value | base64 --decode)          -e DOCMAGIC_URL=$(curl -s http://${COREOS_PRIVATE_IPV4}:8500/v1/kv/service/docmagic/url | jq -r .[].Value | base64 --decode)          -e SERVICE_${EXT_PORT}_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/${CONTEXT} | grep HTTP | grep 200 || exit 255\"          -e NEW_RELIC_APP_NAME=\"${CONTAINER} (${ENV})\"          -e NEW_RELIC_HOST_DISPLAY_NAME=\"%H\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i; sleep 15;'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rmi ${DOCKER_REPO}:${TAG}'"},{"name":"Conflicts","section":"X-Fleet","value":"docmagic-esign*"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"launched","desiredState":"launched","machineID":"279088ab82e84f2d85fa789b89e60cf7","name":"docmagic-esign@1.service","options":[{"name":"Description","section":"Unit","value":"docmagic-esign app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"docmagic-esign"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"EnvironmentFile","section":"Service","value":"/shared/config/vault.env"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/docmagic-esign"},{"name":"Environment","section":"Service","value":"CONTAINER=docmagic-esign"},{"name":"Environment","section":"Service","value":"EXT_PORT=9047"},{"name":"Environment","section":"Service","value":"INT_PORT=9047"},{"name":"Environment","section":"Service","value":"CONTEXT=esign/"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/newrelic:/data/newrelic          -e NODE_IP_ADDR=${COREOS_PRIVATE_IPV4}          -e DB_URL=jdbc:postgresql://$(curl -s http://${COREOS_PRIVATE_IPV4}:8500/v1/catalog/service/postgres-common | jq -r .[].Address):$(curl -s http://${COREOS_PRIVATE_IPV4}:8500/v1/catalog/service/postgres-common | jq -r .[].ServicePort)/sofi_com          -e DB_USER=$(curl -v -H \"X-Vault-Token: ${VAULT_TOKEN}\" ${VAULT_ADDR}v1/secret/db/common | jq -r .data.username)          -e DB_PASS=$(curl -v -H \"X-Vault-Token: ${VAULT_TOKEN}\" ${VAULT_ADDR}v1/secret/db/common | jq -r .data.password)          -e DOCMAGIC_USER=$(curl -v -H \"X-Vault-Token: ${VAULT_TOKEN}\" ${VAULT_ADDR}v1/secret/service/docmagic | jq -r .data.username)          -e DOCMAGIC_PASS=$(curl -v -H \"X-Vault-Token: ${VAULT_TOKEN}\" ${VAULT_ADDR}v1/secret/service/docmagic | jq -r .data.password)          -e DOCMAGIC_ID=$(curl -s http://${COREOS_PRIVATE_IPV4}:8500/v1/kv/service/docmagic/id | jq -r .[].Value | base64 --decode)          -e DOCMAGIC_URL=$(curl -s http://${COREOS_PRIVATE_IPV4}:8500/v1/kv/service/docmagic/url | jq -r .[].Value | base64 --decode)          -e SERVICE_${EXT_PORT}_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/${CONTEXT} | grep HTTP | grep 200 || exit 255\"          -e NEW_RELIC_APP_NAME=\"${CONTAINER} (${ENV})\"          -e NEW_RELIC_HOST_DISPLAY_NAME=\"%H\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i; sleep 15;'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rmi ${DOCKER_REPO}:${TAG}'"},{"name":"Conflicts","section":"X-Fleet","value":"docmagic-esign*"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"inactive","desiredState":"inactive","name":"docmosis-libre@.service","options":[{"name":"Description","section":"Unit","value":"docmosis-libre app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"docmosis-libre"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/docmosis-libre"},{"name":"Environment","section":"Service","value":"CONTAINER=docmosis-libre"},{"name":"Environment","section":"Service","value":"EXT_PORT=3101"},{"name":"Environment","section":"Service","value":"INT_PORT=3101"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s http://${COREOS_PRIVATE_IPV4}:2375/containers/${CONTAINER}/json | grep '\"Running\":true'\"          ${DOCKER_REPO}:${TAG}          /usr/local/docmosis/runConverter.sh 3101'"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i; sleep 30;'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rmi ${DOCKER_REPO}:${TAG}'"},{"name":"Conflicts","section":"X-Fleet","value":"docmosis-libre*"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"launched","desiredState":"launched","machineID":"1e640f5ec22f4a3dbc8fa70b9cd9a445","name":"docmosis-libre@1.service","options":[{"name":"Description","section":"Unit","value":"docmosis-libre app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"docmosis-libre"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/docmosis-libre"},{"name":"Environment","section":"Service","value":"CONTAINER=docmosis-libre"},{"name":"Environment","section":"Service","value":"EXT_PORT=3101"},{"name":"Environment","section":"Service","value":"INT_PORT=3101"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s http://${COREOS_PRIVATE_IPV4}:2375/containers/${CONTAINER}/json | grep '\"Running\":true'\"          ${DOCKER_REPO}:${TAG}          /usr/local/docmosis/runConverter.sh 3101'"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i; sleep 30;'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rmi ${DOCKER_REPO}:${TAG}'"},{"name":"Conflicts","section":"X-Fleet","value":"docmosis-libre*"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"inactive","desiredState":"inactive","name":"docmosis@.service","options":[{"name":"Description","section":"Unit","value":"docmosis app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"docmosis"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/sofi-docmosis"},{"name":"Environment","section":"Service","value":"CONTAINER=docmosis"},{"name":"Environment","section":"Service","value":"EXT_PORT=2101"},{"name":"Environment","section":"Service","value":"INT_PORT=2101"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/sofi/apps/conf:/config          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s http://${COREOS_PRIVATE_IPV4}:2375/containers/${CONTAINER}/json | grep '\"Running\":true'\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i; sleep 30;'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rmi ${DOCKER_REPO}:${TAG}'"},{"name":"Conflicts","section":"X-Fleet","value":"docmosis*"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"launched","desiredState":"launched","machineID":"802a0aaa8af24c5fab603b6b357061f9","name":"docmosis@1.service","options":[{"name":"Description","section":"Unit","value":"docmosis app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"docmosis"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/sofi-docmosis"},{"name":"Environment","section":"Service","value":"CONTAINER=docmosis"},{"name":"Environment","section":"Service","value":"EXT_PORT=2101"},{"name":"Environment","section":"Service","value":"INT_PORT=2101"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/sofi/apps/conf:/config          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s http://${COREOS_PRIVATE_IPV4}:2375/containers/${CONTAINER}/json | grep '\"Running\":true'\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i; sleep 30;'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rmi ${DOCKER_REPO}:${TAG}'"},{"name":"Conflicts","section":"X-Fleet","value":"docmosis*"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"inactive","desiredState":"inactive","name":"document-generation@.service","options":[{"name":"Description","section":"Unit","value":"document generation server app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"document-generation"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"EnvironmentFile","section":"Service","value":"/shared/config/vault.env"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/document-generation"},{"name":"Environment","section":"Service","value":"CONTAINER=document-generation"},{"name":"Environment","section":"Service","value":"EXT_PORT=9191"},{"name":"Environment","section":"Service","value":"INT_PORT=9191"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/newrelic:/data/newrelic          -e ENVIRONMENT=$(curl -s http://${COREOS_PRIVATE_IPV4}:8500/v1/kv/config/global/app_environment | jq -r .[].Value | base64 --decode)          -e NODE_IP=\"${COREOS_PRIVATE_IPV4}\"          -e HOSTNAME=\"%H\"          -e VAULT_ADDR=\"http://active.vault.service.consul:8200\"          -e VAULT_TOKEN=\"${VAULT_TOKEN}\"          -e SERVICE_${EXT_PORT}_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/ | grep HTTP | grep 200 || exit 255\"          -e NEW_RELIC_APP_NAME=\"${CONTAINER} (${ENV})\"          -e NEW_RELIC_HOST_DISPLAY_NAME=\"%H\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i && sleep 5'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"Conflicts","section":"X-Fleet","value":"document-generation@*.service"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"launched","desiredState":"launched","machineID":"277d71246ac8425b832426a818dedca4","name":"document-generation@1.service","options":[{"name":"Description","section":"Unit","value":"document generation server app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"document-generation"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"EnvironmentFile","section":"Service","value":"/shared/config/vault.env"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/document-generation"},{"name":"Environment","section":"Service","value":"CONTAINER=document-generation"},{"name":"Environment","section":"Service","value":"EXT_PORT=9191"},{"name":"Environment","section":"Service","value":"INT_PORT=9191"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/newrelic:/data/newrelic          -e ENVIRONMENT=$(curl -s http://${COREOS_PRIVATE_IPV4}:8500/v1/kv/config/global/app_environment | jq -r .[].Value | base64 --decode)          -e NODE_IP=\"${COREOS_PRIVATE_IPV4}\"          -e HOSTNAME=\"%H\"          -e VAULT_ADDR=\"http://active.vault.service.consul:8200\"          -e VAULT_TOKEN=\"${VAULT_TOKEN}\"          -e SERVICE_${EXT_PORT}_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/ | grep HTTP | grep 200 || exit 255\"          -e NEW_RELIC_APP_NAME=\"${CONTAINER} (${ENV})\"          -e NEW_RELIC_HOST_DISPLAY_NAME=\"%H\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i && sleep 5'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"Conflicts","section":"X-Fleet","value":"document-generation@*.service"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"inactive","desiredState":"inactive","name":"elastic-apps@.service","options":[{"name":"Description","section":"Unit","value":"Elastic Search for Apps"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"elastic-apps"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/sofi-elasticsearch"},{"name":"Environment","section":"Service","value":"TAG=2.4.1"},{"name":"Environment","section":"Service","value":"CONTAINER=elastic-apps"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/mkdir -p /etc/systemd/resolved.conf.d"},{"name":"ExecStartPre","section":"Service","value":"-/bin/bash -c 'mkdir -p /var/lib/docker/elastic-apps/data'"},{"name":"ExecStartPre","section":"Service","value":"-/bin/bash -c 'mkdir -p /var/lib/docker/elastic-apps/logs'"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/docker pull ${DOCKER_REPO}:${TAG}"},{"name":"ExecStart","section":"Service","value":"-/bin/bash -c '      NODES=`fleetctl list-machines -fields ip,metadata | grep \"role=es-app\" | cut -f 1 | tr \"\\n\" \",\" | sed -e \"s/,$//\"`;      echo $NODES;      /usr/bin/docker run --rm --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":9200:9200          -p \"${COREOS_PRIVATE_IPV4}\":9300:9300          -v /var/lib/docker/elastic-apps/data:/usr/share/elasticsearch/data          -v /var/lib/docker/elastic-apps/logs:/usr/share/elasticsearch/logs          -e ES_HEAP_SIZE=2g          -e SERVICE_9200_NAME=\"${CONTAINER}\"          -e SERVICE_9200_ID=\"${CONTAINER}-%i\"          -e SERVICE_9300_NAME=\"elastic-apps-transport\"          -e SERVICE_9300_ID=\"elastic-apps-transport-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:9200/ | grep HTTP | grep 200 || exit 255\"  \t${DOCKER_REPO}:${TAG} -Des.network.bind_host=0.0.0.0 -Des.network.publish_host=${COREOS_PRIVATE_IPV4} --cluster.name \"${CONTAINER}\" --discovery.zen.pin.multicast.enabled false --discovery.zen.ping.unicast.hosts \"$NODES\"'"},{"name":"ExecStop","section":"Service","value":"/usr/bin/docker stop ${CONTAINER}"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=es-app"},{"name":"Conflicts","section":"X-Fleet","value":"elastic-apps@*.service"}]},{"currentState":"launched","desiredState":"launched","machineID":"7f6a32869c824ce28f574dfab0193617","name":"elastic-apps@1.service","options":[{"name":"Description","section":"Unit","value":"Elastic Search for Apps"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"elastic-apps"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/sofi-elasticsearch"},{"name":"Environment","section":"Service","value":"TAG=2.4.1"},{"name":"Environment","section":"Service","value":"CONTAINER=elastic-apps"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/mkdir -p /etc/systemd/resolved.conf.d"},{"name":"ExecStartPre","section":"Service","value":"-/bin/bash -c 'mkdir -p /var/lib/docker/elastic-apps/data'"},{"name":"ExecStartPre","section":"Service","value":"-/bin/bash -c 'mkdir -p /var/lib/docker/elastic-apps/logs'"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/docker pull ${DOCKER_REPO}:${TAG}"},{"name":"ExecStart","section":"Service","value":"-/bin/bash -c '      NODES=`fleetctl list-machines -fields ip,metadata | grep \"role=es-app\" | cut -f 1 | tr \"\\n\" \",\" | sed -e \"s/,$//\"`;      echo $NODES;      /usr/bin/docker run --rm --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":9200:9200          -p \"${COREOS_PRIVATE_IPV4}\":9300:9300          -v /var/lib/docker/elastic-apps/data:/usr/share/elasticsearch/data          -v /var/lib/docker/elastic-apps/logs:/usr/share/elasticsearch/logs          -e ES_HEAP_SIZE=2g          -e SERVICE_9200_NAME=\"${CONTAINER}\"          -e SERVICE_9200_ID=\"${CONTAINER}-%i\"          -e SERVICE_9300_NAME=\"elastic-apps-transport\"          -e SERVICE_9300_ID=\"elastic-apps-transport-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:9200/ | grep HTTP | grep 200 || exit 255\"  \t${DOCKER_REPO}:${TAG} -Des.network.bind_host=0.0.0.0 -Des.network.publish_host=${COREOS_PRIVATE_IPV4} --cluster.name \"${CONTAINER}\" --discovery.zen.pin.multicast.enabled false --discovery.zen.ping.unicast.hosts \"$NODES\"'"},{"name":"ExecStop","section":"Service","value":"/usr/bin/docker stop ${CONTAINER}"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=es-app"},{"name":"Conflicts","section":"X-Fleet","value":"elastic-apps@*.service"}]},{"currentState":"launched","desiredState":"launched","machineID":"d5b3ca3584b54043a1cdffbd9208fb51","name":"elastic-apps@2.service","options":[{"name":"Description","section":"Unit","value":"Elastic Search for Apps"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"elastic-apps"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/sofi-elasticsearch"},{"name":"Environment","section":"Service","value":"TAG=2.4.1"},{"name":"Environment","section":"Service","value":"CONTAINER=elastic-apps"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/mkdir -p /etc/systemd/resolved.conf.d"},{"name":"ExecStartPre","section":"Service","value":"-/bin/bash -c 'mkdir -p /var/lib/docker/elastic-apps/data'"},{"name":"ExecStartPre","section":"Service","value":"-/bin/bash -c 'mkdir -p /var/lib/docker/elastic-apps/logs'"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/docker pull ${DOCKER_REPO}:${TAG}"},{"name":"ExecStart","section":"Service","value":"-/bin/bash -c '      NODES=`fleetctl list-machines -fields ip,metadata | grep \"role=es-app\" | cut -f 1 | tr \"\\n\" \",\" | sed -e \"s/,$//\"`;      echo $NODES;      /usr/bin/docker run --rm --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":9200:9200          -p \"${COREOS_PRIVATE_IPV4}\":9300:9300          -v /var/lib/docker/elastic-apps/data:/usr/share/elasticsearch/data          -v /var/lib/docker/elastic-apps/logs:/usr/share/elasticsearch/logs          -e ES_HEAP_SIZE=2g          -e SERVICE_9200_NAME=\"${CONTAINER}\"          -e SERVICE_9200_ID=\"${CONTAINER}-%i\"          -e SERVICE_9300_NAME=\"elastic-apps-transport\"          -e SERVICE_9300_ID=\"elastic-apps-transport-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:9200/ | grep HTTP | grep 200 || exit 255\"  \t${DOCKER_REPO}:${TAG} -Des.network.bind_host=0.0.0.0 -Des.network.publish_host=${COREOS_PRIVATE_IPV4} --cluster.name \"${CONTAINER}\" --discovery.zen.pin.multicast.enabled false --discovery.zen.ping.unicast.hosts \"$NODES\"'"},{"name":"ExecStop","section":"Service","value":"/usr/bin/docker stop ${CONTAINER}"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=es-app"},{"name":"Conflicts","section":"X-Fleet","value":"elastic-apps@*.service"}]},{"currentState":"launched","desiredState":"launched","machineID":"e4a67f422e284966bdb31997d9c54f32","name":"elastic-apps@3.service","options":[{"name":"Description","section":"Unit","value":"Elastic Search for Apps"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"elastic-apps"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/sofi-elasticsearch"},{"name":"Environment","section":"Service","value":"TAG=2.4.1"},{"name":"Environment","section":"Service","value":"CONTAINER=elastic-apps"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/mkdir -p /etc/systemd/resolved.conf.d"},{"name":"ExecStartPre","section":"Service","value":"-/bin/bash -c 'mkdir -p /var/lib/docker/elastic-apps/data'"},{"name":"ExecStartPre","section":"Service","value":"-/bin/bash -c 'mkdir -p /var/lib/docker/elastic-apps/logs'"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/docker pull ${DOCKER_REPO}:${TAG}"},{"name":"ExecStart","section":"Service","value":"-/bin/bash -c '      NODES=`fleetctl list-machines -fields ip,metadata | grep \"role=es-app\" | cut -f 1 | tr \"\\n\" \",\" | sed -e \"s/,$//\"`;      echo $NODES;      /usr/bin/docker run --rm --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":9200:9200          -p \"${COREOS_PRIVATE_IPV4}\":9300:9300          -v /var/lib/docker/elastic-apps/data:/usr/share/elasticsearch/data          -v /var/lib/docker/elastic-apps/logs:/usr/share/elasticsearch/logs          -e ES_HEAP_SIZE=2g          -e SERVICE_9200_NAME=\"${CONTAINER}\"          -e SERVICE_9200_ID=\"${CONTAINER}-%i\"          -e SERVICE_9300_NAME=\"elastic-apps-transport\"          -e SERVICE_9300_ID=\"elastic-apps-transport-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:9200/ | grep HTTP | grep 200 || exit 255\"  \t${DOCKER_REPO}:${TAG} -Des.network.bind_host=0.0.0.0 -Des.network.publish_host=${COREOS_PRIVATE_IPV4} --cluster.name \"${CONTAINER}\" --discovery.zen.pin.multicast.enabled false --discovery.zen.ping.unicast.hosts \"$NODES\"'"},{"name":"ExecStop","section":"Service","value":"/usr/bin/docker stop ${CONTAINER}"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=es-app"},{"name":"Conflicts","section":"X-Fleet","value":"elastic-apps@*.service"}]},{"currentState":"inactive","desiredState":"inactive","name":"elastic-logs@.service","options":[{"name":"Description","section":"Unit","value":"Elastic Search for Logs"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"elastic-logs"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/sofi-elasticsearch"},{"name":"Environment","section":"Service","value":"TAG=2.4.1"},{"name":"Environment","section":"Service","value":"CONTAINER=elastic-logs"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/mkdir -p /etc/systemd/resolved.conf.d"},{"name":"ExecStartPre","section":"Service","value":"-/bin/bash -c 'mkdir -p /data/elastic-logs/data'"},{"name":"ExecStartPre","section":"Service","value":"-/bin/bash -c 'mkdir -p /data/elastic-logs/logs'"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/docker pull ${DOCKER_REPO}:${TAG}"},{"name":"ExecStart","section":"Service","value":"-/bin/bash -c '      NODES=`fleetctl list-machines -fields ip,metadata | grep \"role=es\" | cut -f 1 | tr \"\\n\" \",\" | sed -e \"s/,$//\"`;      echo $NODES;      /usr/bin/docker run --rm --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":9200:9200          -p \"${COREOS_PRIVATE_IPV4}\":9300:9300          -v /data/elastic-logs/data:/usr/share/elasticsearch/data          -v /data/elastic-logs/logs:/usr/share/elasticsearch/logs          -e ES_HEAP_SIZE=2g          -e SERVICE_9200_NAME=\"${CONTAINER}\"          -e SERVICE_9200_ID=\"${CONTAINER}-%i\"          -e SERVICE_9300_NAME=\"elastic-transport\"          -e SERVICE_9300_ID=\"elastic-transport-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:9200/ | grep HTTP | grep 200 || exit 255\"  \t${DOCKER_REPO}:${TAG} -Des.network.bind_host=0.0.0.0 -Des.network.publish_host=${COREOS_PRIVATE_IPV4} --cluster.name \"${CONTAINER}\" --discovery.zen.pin.multicast.enabled false --discovery.zen.ping.unicast.hosts \"$NODES\"'"},{"name":"ExecStop","section":"Service","value":"/usr/bin/docker stop ${CONTAINER}"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=es"},{"name":"Conflicts","section":"X-Fleet","value":"elastic-logs*"}]},{"currentState":"launched","desiredState":"launched","machineID":"054d4d585bf94dc9adb479ddf7294be4","name":"elastic-logs@1.service","options":[{"name":"Description","section":"Unit","value":"Elastic Search for Logs"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"elastic-logs"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/sofi-elasticsearch"},{"name":"Environment","section":"Service","value":"TAG=2.4.1"},{"name":"Environment","section":"Service","value":"CONTAINER=elastic-logs"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/mkdir -p /etc/systemd/resolved.conf.d"},{"name":"ExecStartPre","section":"Service","value":"-/bin/bash -c 'mkdir -p /data/elastic-logs/data'"},{"name":"ExecStartPre","section":"Service","value":"-/bin/bash -c 'mkdir -p /data/elastic-logs/logs'"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/docker pull ${DOCKER_REPO}:${TAG}"},{"name":"ExecStart","section":"Service","value":"-/bin/bash -c '      NODES=`fleetctl list-machines -fields ip,metadata | grep \"role=es\" | cut -f 1 | tr \"\\n\" \",\" | sed -e \"s/,$//\"`;      echo $NODES;      /usr/bin/docker run --rm --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":9200:9200          -p \"${COREOS_PRIVATE_IPV4}\":9300:9300          -v /data/elastic-logs/data:/usr/share/elasticsearch/data          -v /data/elastic-logs/logs:/usr/share/elasticsearch/logs          -e ES_HEAP_SIZE=2g          -e SERVICE_9200_NAME=\"${CONTAINER}\"          -e SERVICE_9200_ID=\"${CONTAINER}-%i\"          -e SERVICE_9300_NAME=\"elastic-transport\"          -e SERVICE_9300_ID=\"elastic-transport-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:9200/ | grep HTTP | grep 200 || exit 255\"  \t${DOCKER_REPO}:${TAG} -Des.network.bind_host=0.0.0.0 -Des.network.publish_host=${COREOS_PRIVATE_IPV4} --cluster.name \"${CONTAINER}\" --discovery.zen.pin.multicast.enabled false --discovery.zen.ping.unicast.hosts \"$NODES\"'"},{"name":"ExecStop","section":"Service","value":"/usr/bin/docker stop ${CONTAINER}"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=es"},{"name":"Conflicts","section":"X-Fleet","value":"elastic-logs*"}]},{"currentState":"launched","desiredState":"launched","machineID":"6583f8a026c8417fa6f3f4ccec43cb52","name":"elastic-logs@2.service","options":[{"name":"Description","section":"Unit","value":"Elastic Search for Logs"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"elastic-logs"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/sofi-elasticsearch"},{"name":"Environment","section":"Service","value":"TAG=2.4.1"},{"name":"Environment","section":"Service","value":"CONTAINER=elastic-logs"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/mkdir -p /etc/systemd/resolved.conf.d"},{"name":"ExecStartPre","section":"Service","value":"-/bin/bash -c 'mkdir -p /data/elastic-logs/data'"},{"name":"ExecStartPre","section":"Service","value":"-/bin/bash -c 'mkdir -p /data/elastic-logs/logs'"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/docker pull ${DOCKER_REPO}:${TAG}"},{"name":"ExecStart","section":"Service","value":"-/bin/bash -c '      NODES=`fleetctl list-machines -fields ip,metadata | grep \"role=es\" | cut -f 1 | tr \"\\n\" \",\" | sed -e \"s/,$//\"`;      echo $NODES;      /usr/bin/docker run --rm --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":9200:9200          -p \"${COREOS_PRIVATE_IPV4}\":9300:9300          -v /data/elastic-logs/data:/usr/share/elasticsearch/data          -v /data/elastic-logs/logs:/usr/share/elasticsearch/logs          -e ES_HEAP_SIZE=2g          -e SERVICE_9200_NAME=\"${CONTAINER}\"          -e SERVICE_9200_ID=\"${CONTAINER}-%i\"          -e SERVICE_9300_NAME=\"elastic-transport\"          -e SERVICE_9300_ID=\"elastic-transport-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:9200/ | grep HTTP | grep 200 || exit 255\"  \t${DOCKER_REPO}:${TAG} -Des.network.bind_host=0.0.0.0 -Des.network.publish_host=${COREOS_PRIVATE_IPV4} --cluster.name \"${CONTAINER}\" --discovery.zen.pin.multicast.enabled false --discovery.zen.ping.unicast.hosts \"$NODES\"'"},{"name":"ExecStop","section":"Service","value":"/usr/bin/docker stop ${CONTAINER}"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=es"},{"name":"Conflicts","section":"X-Fleet","value":"elastic-logs*"}]},{"currentState":"launched","desiredState":"launched","machineID":"f5a17e03769a4104a249a9649817126e","name":"elastic-logs@3.service","options":[{"name":"Description","section":"Unit","value":"Elastic Search for Logs"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"elastic-logs"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/sofi-elasticsearch"},{"name":"Environment","section":"Service","value":"TAG=2.4.1"},{"name":"Environment","section":"Service","value":"CONTAINER=elastic-logs"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/mkdir -p /etc/systemd/resolved.conf.d"},{"name":"ExecStartPre","section":"Service","value":"-/bin/bash -c 'mkdir -p /data/elastic-logs/data'"},{"name":"ExecStartPre","section":"Service","value":"-/bin/bash -c 'mkdir -p /data/elastic-logs/logs'"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/docker pull ${DOCKER_REPO}:${TAG}"},{"name":"ExecStart","section":"Service","value":"-/bin/bash -c '      NODES=`fleetctl list-machines -fields ip,metadata | grep \"role=es\" | cut -f 1 | tr \"\\n\" \",\" | sed -e \"s/,$//\"`;      echo $NODES;      /usr/bin/docker run --rm --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":9200:9200          -p \"${COREOS_PRIVATE_IPV4}\":9300:9300          -v /data/elastic-logs/data:/usr/share/elasticsearch/data          -v /data/elastic-logs/logs:/usr/share/elasticsearch/logs          -e ES_HEAP_SIZE=2g          -e SERVICE_9200_NAME=\"${CONTAINER}\"          -e SERVICE_9200_ID=\"${CONTAINER}-%i\"          -e SERVICE_9300_NAME=\"elastic-transport\"          -e SERVICE_9300_ID=\"elastic-transport-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:9200/ | grep HTTP | grep 200 || exit 255\"  \t${DOCKER_REPO}:${TAG} -Des.network.bind_host=0.0.0.0 -Des.network.publish_host=${COREOS_PRIVATE_IPV4} --cluster.name \"${CONTAINER}\" --discovery.zen.pin.multicast.enabled false --discovery.zen.ping.unicast.hosts \"$NODES\"'"},{"name":"ExecStop","section":"Service","value":"/usr/bin/docker stop ${CONTAINER}"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=es"},{"name":"Conflicts","section":"X-Fleet","value":"elastic-logs*"}]},{"currentState":"launched","desiredState":"launched","machineID":"dfa381281f6244f48c5ac0d407979b06","name":"elastic-logs@4.service","options":[{"name":"Description","section":"Unit","value":"Elastic Search for Logs"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"elastic-logs"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/sofi-elasticsearch"},{"name":"Environment","section":"Service","value":"TAG=2.4.1"},{"name":"Environment","section":"Service","value":"CONTAINER=elastic-logs"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/mkdir -p /etc/systemd/resolved.conf.d"},{"name":"ExecStartPre","section":"Service","value":"-/bin/bash -c 'mkdir -p /data/elastic-logs/data'"},{"name":"ExecStartPre","section":"Service","value":"-/bin/bash -c 'mkdir -p /data/elastic-logs/logs'"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/docker pull ${DOCKER_REPO}:${TAG}"},{"name":"ExecStart","section":"Service","value":"-/bin/bash -c '      NODES=`fleetctl list-machines -fields ip,metadata | grep \"role=es\" | cut -f 1 | tr \"\\n\" \",\" | sed -e \"s/,$//\"`;      echo $NODES;      /usr/bin/docker run --rm --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":9200:9200          -p \"${COREOS_PRIVATE_IPV4}\":9300:9300          -v /data/elastic-logs/data:/usr/share/elasticsearch/data          -v /data/elastic-logs/logs:/usr/share/elasticsearch/logs          -e ES_HEAP_SIZE=2g          -e SERVICE_9200_NAME=\"${CONTAINER}\"          -e SERVICE_9200_ID=\"${CONTAINER}-%i\"          -e SERVICE_9300_NAME=\"elastic-transport\"          -e SERVICE_9300_ID=\"elastic-transport-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:9200/ | grep HTTP | grep 200 || exit 255\"  \t${DOCKER_REPO}:${TAG} -Des.network.bind_host=0.0.0.0 -Des.network.publish_host=${COREOS_PRIVATE_IPV4} --cluster.name \"${CONTAINER}\" --discovery.zen.pin.multicast.enabled false --discovery.zen.ping.unicast.hosts \"$NODES\"'"},{"name":"ExecStop","section":"Service","value":"/usr/bin/docker stop ${CONTAINER}"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=es"},{"name":"Conflicts","section":"X-Fleet","value":"elastic-logs*"}]},{"currentState":"launched","desiredState":"launched","machineID":"01139fac1f9d44649af44c893488cd2c","name":"elastic-logs@5.service","options":[{"name":"Description","section":"Unit","value":"Elastic Search for Logs"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"elastic-logs"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/sofi-elasticsearch"},{"name":"Environment","section":"Service","value":"TAG=2.4.1"},{"name":"Environment","section":"Service","value":"CONTAINER=elastic-logs"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/mkdir -p /etc/systemd/resolved.conf.d"},{"name":"ExecStartPre","section":"Service","value":"-/bin/bash -c 'mkdir -p /data/elastic-logs/data'"},{"name":"ExecStartPre","section":"Service","value":"-/bin/bash -c 'mkdir -p /data/elastic-logs/logs'"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/docker pull ${DOCKER_REPO}:${TAG}"},{"name":"ExecStart","section":"Service","value":"-/bin/bash -c '      NODES=`fleetctl list-machines -fields ip,metadata | grep \"role=es\" | cut -f 1 | tr \"\\n\" \",\" | sed -e \"s/,$//\"`;      echo $NODES;      /usr/bin/docker run --rm --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":9200:9200          -p \"${COREOS_PRIVATE_IPV4}\":9300:9300          -v /data/elastic-logs/data:/usr/share/elasticsearch/data          -v /data/elastic-logs/logs:/usr/share/elasticsearch/logs          -e ES_HEAP_SIZE=2g          -e SERVICE_9200_NAME=\"${CONTAINER}\"          -e SERVICE_9200_ID=\"${CONTAINER}-%i\"          -e SERVICE_9300_NAME=\"elastic-transport\"          -e SERVICE_9300_ID=\"elastic-transport-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:9200/ | grep HTTP | grep 200 || exit 255\"  \t${DOCKER_REPO}:${TAG} -Des.network.bind_host=0.0.0.0 -Des.network.publish_host=${COREOS_PRIVATE_IPV4} --cluster.name \"${CONTAINER}\" --discovery.zen.pin.multicast.enabled false --discovery.zen.ping.unicast.hosts \"$NODES\"'"},{"name":"ExecStop","section":"Service","value":"/usr/bin/docker stop ${CONTAINER}"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=es"},{"name":"Conflicts","section":"X-Fleet","value":"elastic-logs*"}]},{"currentState":"inactive","desiredState":"inactive","name":"email-service@.service","options":[{"name":"Description","section":"Unit","value":"email-service app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"email-service"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/email-service"},{"name":"Environment","section":"Service","value":"CONTAINER=email-service"},{"name":"Environment","section":"Service","value":"EXT_PORT=9027"},{"name":"Environment","section":"Service","value":"INT_PORT=9000"},{"name":"Environment","section":"Service","value":"CONTEXT=email/"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/sofi/apps/conf:/config          -v /data/newrelic:/data/newrelic          -v /shared:/shared          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/${CONTEXT} | grep HTTP | grep 200 || exit 255\"          -e NEW_RELIC_APP_NAME=\"${CONTAINER} (${ENV})\"          -e NEW_RELIC_HOST_DISPLAY_NAME=\"%H\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i; sleep 15;'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"Conflicts","section":"X-Fleet","value":"email*"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"launched","desiredState":"launched","machineID":"8347693a19394ab58867d3863eec5581","name":"email-service@2.service","options":[{"name":"Description","section":"Unit","value":"email-service app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"email-service"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/email-service"},{"name":"Environment","section":"Service","value":"CONTAINER=email-service"},{"name":"Environment","section":"Service","value":"EXT_PORT=9027"},{"name":"Environment","section":"Service","value":"INT_PORT=9000"},{"name":"Environment","section":"Service","value":"CONTEXT=email/"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/sofi/apps/conf:/config          -v /data/newrelic:/data/newrelic          -v /shared:/shared          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/${CONTEXT} | grep HTTP | grep 200 || exit 255\"          -e NEW_RELIC_APP_NAME=\"${CONTAINER} (${ENV})\"          -e NEW_RELIC_HOST_DISPLAY_NAME=\"%H\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i; sleep 15;'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"Conflicts","section":"X-Fleet","value":"email*"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"inactive","desiredState":"inactive","name":"es-backup@.service","options":[{"name":"Description","section":"Unit","value":"ElasticSearch Snapshot Service"},{"name":"SyslogIdentifier","section":"Service","value":"elasticsearch-snapshot"},{"name":"Restart","section":"Service","value":"always"},{"name":"RestartSec","section":"Service","value":"3600"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"ES_HOST=elastic-logs.service.consul"},{"name":"Environment","section":"Service","value":"REPO=es-staging"},{"name":"Environment","section":"Service","value":"LIMIT=24"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      SNAPSHOT=\"\"\"$(date +%Y%m%d-%H%M%S)\"\"\";      echo \"Creating Snapshot: $SNAPSHOT\";      curl -XPUT \"${ES_HOST}:9200/_snapshot/${REPO}/$SNAPSHOT?wait_for_completion=true\";      SNAPSHOTS=$(curl -s -XGET \"${ES_HOST}:9200/_snapshot/${REPO}/_all\" | jq -r \".snapshots[:-${LIMIT}][].snapshot\");      for SNAPSHOT in $SNAPSHOTS;        do echo \"Deleting snapshot: $SNAPSHOT\";        curl -s -XDELETE \"${ES_HOST}:9200/_snapshot/${REPO}/$SNAPSHOT?pretty\";      done'"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=es"}]},{"currentState":"launched","desiredState":"launched","machineID":"054d4d585bf94dc9adb479ddf7294be4","name":"es-backup@1.service","options":[{"name":"Description","section":"Unit","value":"ElasticSearch Snapshot Service"},{"name":"SyslogIdentifier","section":"Service","value":"elasticsearch-snapshot"},{"name":"Restart","section":"Service","value":"always"},{"name":"RestartSec","section":"Service","value":"3600"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"ES_HOST=elastic-logs.service.consul"},{"name":"Environment","section":"Service","value":"REPO=es-staging"},{"name":"Environment","section":"Service","value":"LIMIT=24"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      SNAPSHOT=\"\"\"$(date +%Y%m%d-%H%M%S)\"\"\";      echo \"Creating Snapshot: $SNAPSHOT\";      curl -XPUT \"${ES_HOST}:9200/_snapshot/${REPO}/$SNAPSHOT?wait_for_completion=true\";      SNAPSHOTS=$(curl -s -XGET \"${ES_HOST}:9200/_snapshot/${REPO}/_all\" | jq -r \".snapshots[:-${LIMIT}][].snapshot\");      for SNAPSHOT in $SNAPSHOTS;        do echo \"Deleting snapshot: $SNAPSHOT\";        curl -s -XDELETE \"${ES_HOST}:9200/_snapshot/${REPO}/$SNAPSHOT?pretty\";      done'"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=es"}]},{"currentState":"inactive","desiredState":"inactive","name":"es_backup@.service","options":[{"name":"Description","section":"Unit","value":"ElasticSearch Snapshot Service"},{"name":"SyslogIdentifier","section":"Service","value":"elasticsearch-snapshot"},{"name":"Restart","section":"Service","value":"always"},{"name":"RestartSec","section":"Service","value":"60"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"ES_HOST=elastic-logs.service.consul"},{"name":"Environment","section":"Service","value":"REPO=es-staging"},{"name":"Environment","section":"Service","value":"LIMIT=5"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      SNAPSHOT=\"\"\"$(date +%Y%m%d-%H%M%S)\"\"\";      echo \"Creating Snapshot: $SNAPSHOT\";      curl -XPUT \"${ES_HOST}:9200/_snapshot/${REPO}/$SNAPSHOT?wait_for_completion=true\";      SNAPSHOTS=$(curl -s -XGET \"${ES_HOST}:9200/_snapshot/${REPO}/_all\" | jq -r \".snapshots[:-${LIMIT}][].snapshot\");      for SNAPSHOT in $SNAPSHOTS;        do echo \"Deleting snapshot: $SNAPSHOT\";        curl -s -XDELETE \"${ES_HOST}:9200/_snapshot/${REPO}/$SNAPSHOT?pretty\";      done'"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=es"}]},{"currentState":"inactive","desiredState":"inactive","name":"esbackup@.service","options":[{"name":"Description","section":"Unit","value":"ElasticSearch Snapshot Service"},{"name":"Type","section":"Service","value":"simple"},{"name":"SyslogIdentifier","section":"Service","value":"elasticsearch-snapshot"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"ES_HOST=elastic-logs.service.consul"},{"name":"Environment","section":"Service","value":"REPO=es_daily_backup"},{"name":"Environment","section":"Service","value":"LIMIT=24"},{"name":"Environment","section":"Service","value":"\"NOW=$(/bin/date +%%Y%%m%%d-%%H%%M%%S)\""},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      echo \"Creating Snapshot: ${NOW}\";      curl -XPUT \"${ES_HOST}:9200/_snapshot/${REPO}/${NOW}?wait_for_completion=true\";      SNAPSHOTS=$(curl -s -XGET \"${ES_HOST}:9200/_snapshot/${REPO}/_all\" | jq -r \".snapshots[:-${LIMIT}][].snapshot\");      for SNAPSHOT in $SNAPSHOTS;        do echo \"Deleting snapshot: $SNAPSHOT\";        curl -s -XDELETE \"${ES_HOST}:9200/_snapshot/${REPO}/$SNAPSHOT?pretty\";      done'"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=es"}]},{"currentState":"inactive","desiredState":"inactive","name":"esbackup@.timer","options":[{"name":"Description","section":"Unit","value":"Run esbackup service hourly"},{"name":"OnCalendar","section":"Timer","value":"*:0/5"},{"name":"Unit","section":"Timer","value":"%p@%i.service"},{"name":"WantedBy","section":"Install","value":"timers.target"},{"name":"MachineOf","section":"X-Fleet","value":"%p@%i.service"}]},{"currentState":"inactive","desiredState":"inactive","name":"esbackup_daily@.service","options":[{"name":"Description","section":"Unit","value":"ElasticSearch Daily Snapshot Service"},{"name":"SyslogIdentifier","section":"Service","value":"elasticsearch-snapshot"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"ES_HOST=elastic-logs.service.consul"},{"name":"Environment","section":"Service","value":"REPO=es_daily_backup"},{"name":"Environment","section":"Service","value":"LIMIT=45"},{"name":"Environment","section":"Service","value":"\"NOW=$(/bin/date +%%Y%%m%%d-%%H%%M%%S)\""},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      echo \"Creating Snapshot: ${NOW}\";      curl -XPUT \"${ES_HOST}:9200/_snapshot/${REPO}/${NOW}?wait_for_completion=true\";      SNAPSHOTS=$(curl -s -XGET \"${ES_HOST}:9200/_snapshot/${REPO}/_all\" | jq -r \".snapshots[:-${LIMIT}][].snapshot\");      for SNAPSHOT in $SNAPSHOTS;        do echo \"Deleting snapshot: $SNAPSHOT\";        curl -s -XDELETE \"${ES_HOST}:9200/_snapshot/${REPO}/$SNAPSHOT?pretty\";      done'"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=es"},{"name":"Conflicts","section":"X-Fleet","value":"esbackup_daily@*.service"}]},{"currentState":"inactive","desiredState":"inactive","name":"esbackup_daily@.timer","options":[{"name":"Description","section":"Unit","value":"Run esbackup_daily service every day"},{"name":"OnCalendar","section":"Timer","value":"*-*-* 22:27:00"},{"name":"Persistent","section":"Timer","value":"True"},{"name":"Unit","section":"Timer","value":"%p@%i.service"},{"name":"WantedBy","section":"Install","value":"timers.target"},{"name":"MachineOf","section":"X-Fleet","value":"%p@%i.service"}]},{"currentState":"inactive","desiredState":"launched","name":"esbackup_daily@1.timer","options":[{"name":"Description","section":"Unit","value":"Run esbackup_daily service every day"},{"name":"OnCalendar","section":"Timer","value":"*-*-* 22:27:00"},{"name":"Persistent","section":"Timer","value":"True"},{"name":"Unit","section":"Timer","value":"%p@%i.service"},{"name":"WantedBy","section":"Install","value":"timers.target"},{"name":"MachineOf","section":"X-Fleet","value":"%p@%i.service"}]},{"currentState":"inactive","desiredState":"inactive","name":"esig@.service","options":[{"name":"Description","section":"Unit","value":"esig app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"esig"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/esig"},{"name":"Environment","section":"Service","value":"CONTAINER=esig"},{"name":"Environment","section":"Service","value":"EXT_PORT=9030"},{"name":"Environment","section":"Service","value":"INT_PORT=9000"},{"name":"Environment","section":"Service","value":"CONTEXT=v/"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/newrelic:/data/newrelic          --env-file=/data/sofi/apps/conf/esig.conf          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/${CONTEXT} | grep HTTP | grep 200 || exit 255\"          -e NEW_RELIC_APP_NAME=\"${CONTAINER} (${ENV})\"          -e NEW_RELIC_HOST_DISPLAY_NAME=\"%H\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i; sleep 10;'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"Conflicts","section":"X-Fleet","value":"esig*"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"launched","desiredState":"launched","machineID":"277d71246ac8425b832426a818dedca4","name":"esig@1.service","options":[{"name":"Description","section":"Unit","value":"esig app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"esig"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/esig"},{"name":"Environment","section":"Service","value":"CONTAINER=esig"},{"name":"Environment","section":"Service","value":"EXT_PORT=9030"},{"name":"Environment","section":"Service","value":"INT_PORT=9000"},{"name":"Environment","section":"Service","value":"CONTEXT=v/"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/newrelic:/data/newrelic          --env-file=/data/sofi/apps/conf/esig.conf          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/${CONTEXT} | grep HTTP | grep 200 || exit 255\"          -e NEW_RELIC_APP_NAME=\"${CONTAINER} (${ENV})\"          -e NEW_RELIC_HOST_DISPLAY_NAME=\"%H\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i; sleep 10;'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"Conflicts","section":"X-Fleet","value":"esig*"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"launched","desiredState":"launched","machineID":"279088ab82e84f2d85fa789b89e60cf7","name":"esig@2.service","options":[{"name":"Description","section":"Unit","value":"esig app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"SyslogIdentifier","section":"Service","value":"esig"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"EnvironmentFile","section":"Service","value":"/etc/environment"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/esig"},{"name":"Environment","section":"Service","value":"CONTAINER=esig"},{"name":"Environment","section":"Service","value":"EXT_PORT=9030"},{"name":"Environment","section":"Service","value":"INT_PORT=9000"},{"name":"Environment","section":"Service","value":"CONTEXT=v/"},{"name":"Environment","section":"Service","value":"\"ENV=$(etcdctl get /docker/environment)\""},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"/bin/bash -c '      /usr/bin/docker run --name ${CONTAINER} -h %H          -p \"${COREOS_PRIVATE_IPV4}\":${EXT_PORT}:${INT_PORT}          -v /data/newrelic:/data/newrelic          --env-file=/data/sofi/apps/conf/esig.conf          -e SERVICE_NAME=\"${CONTAINER}\"          -e SERVICE_ID=\"${CONTAINER}-%i\"          -e SERVICE_CHECK_SCRIPT=\"curl -s -I http://${COREOS_PRIVATE_IPV4}:${EXT_PORT}/${CONTEXT} | grep HTTP | grep 200 || exit 255\"          -e NEW_RELIC_APP_NAME=\"${CONTAINER} (${ENV})\"          -e NEW_RELIC_HOST_DISPLAY_NAME=\"%H\"          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"-/bin/bash -c 'curl http://${COREOS_PRIVATE_IPV4}:8500/v1/agent/service/deregister/${CONTAINER}-%i; sleep 10;'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"Conflicts","section":"X-Fleet","value":"esig*"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"inactive","desiredState":"inactive","name":"etcd-backup-cleanup@.service","options":[{"name":"Description","section":"Unit","value":"etcd-backup-cleanup app"},{"name":"After","section":"Unit","value":"docker.service"},{"name":"Requires","section":"Unit","value":"docker.service"},{"name":"After","section":"Unit","value":"etcd2.service"},{"name":"Requires","section":"Unit","value":"etcd2.service"},{"name":"Type","section":"Service","value":"simple"},{"name":"SyslogIdentifier","section":"Service","value":"etcd-backup-cleanup"},{"name":"TimeoutStartSec","section":"Service","value":"0"},{"name":"Environment","section":"Service","value":"CONTAINER=etcd-backup-cleanup"},{"name":"Environment","section":"Service","value":"DOCKER_REPO=build.sofi.com:5000/${CONTAINER}"},{"name":"Environment","section":"Service","value":"\"TAG=$(etcdctl get /docker/${CONTAINER}/version/current)\""},{"name":"EnvironmentFile","section":"Service","value":"/data/sofi/apps/conf/etcd-backup.env"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker kill ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"-/usr/bin/docker rm ${CONTAINER}"},{"name":"ExecStartPre","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker pull ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStart","section":"Service","value":"-/bin/bash -c '      \t/usr/bin/docker run --name ${CONTAINER}      \t--env-file=/data/sofi/apps/conf/etcd-backup.env      \t--privileged=True          ${DOCKER_REPO}:${TAG}'"},{"name":"ExecStop","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker stop ${CONTAINER}'"},{"name":"ExecStop","section":"Service","value":"/usr/bin/bash -c '/usr/bin/docker rm -v ${CONTAINER}'"},{"name":"Conflicts","section":"X-Fleet","value":"${CONTAINER}*"},{"name":"MachineMetadata","section":"X-Fleet","value":"role=app"}]},{"currentState":"inactive","desiredState":"inactive","name":"etcd-backup-cleanup@.timer","options":[{"name":"Description","section":"Unit","value":"Run etcd-backup service daily"},{"name":"OnCalendar","section":"Timer","value":"*-*-* 12:00:00"},{"name":"Unit","section":"Timer","value":"%p@%i.service"},{"name":"WantedBy","section":"Install","value":"timers.target"},{"name":"MachineOf","section":"X-Fleet","value":"%p@%i.service"}]}]}