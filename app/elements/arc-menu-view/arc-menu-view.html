<dom-module id="arc-menu-view">
  <template>
    <style>
     :host {
      display: block;
      height: 100%;
      background-color: #EEEEEE;
      @apply(--layout-vertical);

      --item-selected-background: #00A2DF;


      --paper-item-focused: {
        background-color: var(--item-selected-background);
        color: #fff;
      }

      --paper-item-focused-before: {
        background-color: transparent;
      }
    }

     :host(arc-menu-view[with-toast]) .bottom-menu {
      bottom: 72px;
    }

    paper-menu {
      @apply(--layout-flex);
      background-color: #EEEEEE;
    }

    paper-item {
      cursor: pointer;
      transition: background-color 0.15s linear;
      background-color: var(--raml-docs-tree-item-background, transparent);
    }

    paper-item.iron-selected {
      background-color: var(--item-selected-background);
      color: #fff;
    }

    paper-item:not(:focus):not(.iron-selected):not([selected]):hover {
      background-color: #cccccc;
    }

    .bottom-menu {
      position: relative;
      bottom: 0;
      transition: bottom 200ms ease-in-out;
      background-color: transparent;
    }

     :host([is-request]) .bottom-menu {
      background-color: #EEEEEE;
    }

    .icon-buttons {
      padding-left: 8px;
      @apply(--layout-horizontal);
      @apply(--layout-center);
    }

    .visible-icons {
      @apply(--layout-flex);
    }

    .sublist {
      padding-left: 20px;
    }

    .project-name {
      @apply(--layout-flex);
      text-overflow: ellipsis;
      overflow: hidden;
    }

    .edit-project-icon {
      display: none;
    }

    .project-item:hover .edit-project-icon {
      display: initial;
    }

    .project-item[selected] {
      background-color: #FF9800;
      color: #fff;
    }

    paper-item.project-item {
      --paper-item-focused: {
        background-color: #FF9800;
      }
    }

    paper-item.project-item[focused],
    paper-item.project-item:focus {
      background-color: #FF9800;
    }

    paper-item.project-item[focused] paper-icon-button,
    paper-item.project-item[selected] paper-icon-button{
      color: #fff;
    }

    paper-item.project-item[focused] paper-icon-button:hover,
    paper-item.project-item[selected] paper-icon-button:hover {
      color: var(--hover-button-accent-color);
    }

    paper-menu-button {
      padding: 0;
    }

    paper-progress {
      width: 100%;
    }

    .empty-request-icon {
      width: 16px;
      height: 16px;
      color: orange;
      margin-right: 4px;
    }
    </style>
    <paper-menu selected="[[route]]" attr-for-selected="data-route" on-tap="_itemTap">
      <paper-item data-route="request" data-place$="[[baseUrl]]">Request</paper-item>
      <paper-item data-route="socket" data-place$="[[baseUrl]]socket">Socket</paper-item>
      <paper-submenu id="projectsSubmenu">
        <paper-item class="menu-trigger">Projects</paper-item>
        <paper-menu class="menu-content sublist" selected="[[route]]" attr-for-selected="data-route" on-tap="_itemTap">
          <paper-progress hidden$="[[!loading]]" indeterminate></paper-progress>
          <paper-item hidden$="[[hasProjects]]">No projects here</paper-item>
          <template is="dom-repeat" items="[[projects]]">
            <paper-item data-route$="request/project/[[item.id]]" data-place$="[[baseUrl]]request/project/[[item.id]]" class="project-item" selected$="[[_computeProjectSelected(item.id, selectedProject)]]">
              <iron-icon hidden$="[[!item.isEmpty]]" icon="icons:warning" class="empty-request-icon" title="This project has no requests"></iron-icon>
              <div class="project-name">[[item.name]]</div>
              <paper-icon-button class="edit-project-icon" data-place$="[[baseUrl]]project/[[item.id]]/edit" icon="arc:mode-edit" alt="Edit project"></paper-icon-button>
            </paper-item>
          </template>
        </paper-menu>
      </paper-submenu>
      <paper-item data-route="saved" data-place$="[[baseUrl]]saved">Saved</paper-item>
      <template is="dom-if" if="{{!noHistory}}">
        <paper-item data-route="history" data-place$="[[baseUrl]]history">History</paper-item>
      </template>
      <paper-item data-route="dataimport" data-place$="[[baseUrl]]dataimport">Import / export</paper-item>
    </paper-menu>
    <section class="bottom-menu" id="bottomMenu" on-tap="_itemTap">
      <div class="icon-buttons">
        <div class="visible-icons">
          <paper-icon-button icon="settings" data-route="settings" data-place$="[[baseUrl]]settings" title="Settings"></paper-icon-button>
          <paper-icon-button icon="info" data-route="about" data-place$="[[baseUrl]]about" title="About app"></paper-icon-button>
          <paper-icon-button icon="bug-report" title="File a bug report" on-tap="newIssueReport"></paper-icon-button>
          <paper-icon-button icon="open-in-new" title="Open new window" on-tap="openNewWindow"></paper-icon-button>
        </div>
        <paper-menu-button vertical-align="bottom" horizontal-align="left">
          <paper-icon-button icon="more-vert" class="dropdown-trigger" on-tap="_actionsMenuOpened"></paper-icon-button>
          <paper-menu class="dropdown-content" id="actionsMenu" on-iron-select="_contextMenuAction">
            <paper-icon-item data-action="rate-review">
              <iron-icon icon="arc:rate-review" item-icon title="Rate &amp; review the app"></iron-icon>
              Rate and review
            </paper-icon-item>
            <paper-icon-item data-action="view-logs">
              <iron-icon icon="list" item-icon title="See log collected by the app"></iron-icon>
              Logs
            </paper-icon-item>
          </paper-menu>
        </paper-menu-button>
      </div>
    </section>
  </template>
  <script src="arc-menu-view.js"></script>
</dom-module>
